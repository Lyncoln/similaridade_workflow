Lucille Delisle ATACseq (release v0.5) PE fastq input Input dataset collection reference_genome Input parameter effective_genome_size Input parameter bin_size Input parameter Cutadapt out_pairs report cutadapt Bowtie2 output mapping_stats bowtie2 Filter BAM out_file2 out_file1 bamtools_filter Samtools idxstats output samtools_idxstats MarkDuplicates metrics_file outFile picard Text reformatting outfile text_processing bedtools BAM to BED output bedtools Paired-end histogram output1 output2 pe_histogram Samtools view outputcnt samtools_view MACS2 callpeak output_tabular output_narrowpeaks output_summits output_treat_pileup output_control_lambda output_extra_files macs2 Compute out_file1 column_maker bedtools SlopBed output bedtools Search in textfiles output text_processing Wig/BedGraph-to-bigWig out_file1 Parse parameter value text_param bedtools MergeBED output bedtools advancedOpt bigwigAverage outFileName deeptools_bigwig_average bedtools Compute both the depth and breadth of coverage output bedtools Text reformatting outfile text_processing Compute out_file1 column_maker Concatenate datasets out_file1 Parse parameter value text_param Text reformatting outfile text_processing advancedOpt bigwigAverage outFileName deeptools_bigwig_average MultiQC stats plots html_report multiqc ATACseq runtime parameter for tool bigwigAverage runtime parameter for tool bigwigAverage PE fastq input reference_genome effective_genome_size bin_size Cutadapt (remove adapter + bad quality bases) Bowtie2 map on reference mapping stats filter MAPQ30 concordant pairs and not mitochondrial pairs Get number of reads per chromosome remove PCR duplicates BAM filtered rmDup MarkDuplicates metrics reads in chrM/MT for multiQC convert BAM to BED to improve peak calling Compute fragment length histogram histogram of fragment length number of reads Call Peak with MACS2 MACS2 narrowPeak compute 1/million reads get summits +/-500kb summary of MACS2 MACS2 report Bigwig from MACS2 (no norm) Coverage from MACS2 (bigwig) Convert 1/million reads to parameter Merge summits +/-500kb 1kb around summits normalize by million reads bigwig_norm Compute coverage on summits +/-500kb number of reads in peaks Nb of reads in summits +-500bp compute 1/million reads in peaks Combine number of reads in peaks with total number of reads Convert 1/million reads in peaks to parameter reads in peaks multiQC normalize by million reads in peaks bigwig_norm2 MultiQC webpage MultiQC on input dataset(s): Stats