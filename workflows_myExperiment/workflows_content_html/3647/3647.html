








  


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="google-site-verification" content="3hq0Cfhw5_-EaaNMum0ETX847sTl7jeQ3ZNAla4a6UQ" />
  
  <title>myExperiment &#45; Workflows &#45; BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation (Robert Kulawik) [Taverna 2 Workflow]</title>
  <link rel="alternate" href="http://www.myexperiment.org/workflows/3647.rdf" type="application/rdf+xml" title="RDF+XML" />
  <link rel="alternate" href="http://www.myexperiment.org/workflows/3647.xml" type="application/xml" title="REST XML" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
  <link href="/stylesheets/acts_as_taggable_stylesheet.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/star_rating.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/gadgets.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/misc_skinning.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/pagination.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/bootstrap.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/navbar.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/styles.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/biovel.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/jquery-1.11.1.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/jquery-noconflict.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/prototype-1.7.2-patched.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/effects.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/dragdrop.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/controls.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/boxover.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/bootstrap.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/tabs.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/folds.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/application.js?1680607579" type="text/javascript"></script>

  
  






  
  
    <script src='//www.google.com/recaptcha/api.js'></script>
  
</head>
<body>



<div class="navbar navbar-myexp" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
          
  <a href="http://biovel.eu/" style="float: left"><img alt="Biovel_logo_white_background" height="50" src="/images/biovel_logo_white_background.png?1680607579" width="38" /></a>
      
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        
          
  <ul class="nav navbar-nav">
    
      <li >
        <a href="/groups/643">BioVeL</a>      </li>
    
      <li id="selected_tabnav">
        <a href="/groups/643/workflows">Workflows</a>      </li>
    
      <li >
        <a href="/groups/643/files">Files</a>      </li>
    
      <li >
        <a href="/groups/643/packs">Packs</a>      </li>
    
  </ul>

        
        
            <form action="/search" class="navbar-form navbar-left" id="search" method="get">
    <div class="input-group">
      <input class="form-control" id="query" name="query" placeholder="Search" type="text" />
      <span class="input-group-btn">
        
        <input class="btn btn-default" name="commit" type="submit" value="Go" />
        </span>
    </div>
</form>

        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
            <li><a href="/session/new?return_to=%2Fworkflows%2F3647.html">Log in</a></li>
    <li><a href="/users/new">Register</a></li>


      </ul>
    </div><!--/.nav-collapse -->
  </div>
  
      <div id="site_info_links">
        <div class="container">
          
    <a href="/home">Back to <img alt="Logo_tiny" src="/images/logo_tiny.png?1680607579" style="vertical-align: bottom" /></a>    <span class="divider">|</span>
    <a href="http://www.biovel.eu/about-biovel" target="blank">About BioVeL</a>
    <span class="divider">|</span>
    <a href="http://portal.biovel.eu" target="blank">BioVeL Portal</a>
    <span class="divider">|</span>
    <a href="https://www.biodiversitycatalogue.org/" target="blank">Biodiversity Catalogue</a>

        </div>
      </div>
  
</div>




    <div class="container" id="main">
      <div id="myexp_breadcrumbs_bar">
        <ol class="breadcrumb">
  <li><a href="/home">Home</a></li>
  


  <li><a href="/workflows">Workflows</a></li>



  
    <li>BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</li>
  


  <div style="float: right"></div>
</ol>

      </div>
      <div id="myexp_content">
        


        



<h1 class="contribution_title">
  BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation
</h1>

<div class="contribution_aftertitle">
	<b>Created:</b> 2013-07-08 15:06:00
	
		&nbsp;&nbsp;&nbsp;&nbsp;
		<b>Last updated: </b>2016-06-22 14:45:16
	
</div>
<ul class="sectionIcons">
  
      <li><span class="icon"><a href="http://www.myexperiment.org/workflows/3647/download/BioVeL_ESW_DIFF_-_ENM_Statistical_Workflow_with_raster_difference_computation-v16.t2flow?version=16"><img alt="Download Workflow (for version 16)" src="/images/redmond_studio/arrow-down_16.png?1680607579" /> Download Workflow</a></span></li>
      
  
      
</ul>


<div class="contribution_left_box">

  <div class="contribution_version_box">



    <div class="contribution_version_inner_box">

      
    <div class="contribution_description">
      <p>
The ENM Statistical Difference Workflow (ESW DIFF) allows the computation of the extent and intensity of change in species potential distribution through computation of the differences between two raster layers using the R statistical environment (R Core Team 2013). The difference file is computed from two input files (in this case present projection and 2050 projection) coming from the Ecological Niche Modelling (ENM) Workflow (<a href="http://www.myexperiment.org/workflows/3355" rel="nofollow">http://www.myexperiment.org/workflows/3355</a>).
</p>

<p>
The difference between each corresponding raster cell value is computed and stored in the difference file, regardless of the input files’ geographical extent and origin. If the files have a different geographical extent and/or origin the raster-diff workflow automatically crops them to the same extent and resamples the values using the “nearest neighbour” method, resulting in a perfect cell match between the two rasters. The resulting value in the difference file ranges from the negative and positive maximum values of the input files to represent the maximum possible change in both directions. 
</p>

<p>
The diff result values are classified into six positive and negative classes. The predicted differences are presented for each species as a heat map, where cells with colors from green to red indicate an increase and from green to blue a decrease of predicted potential for a species. The workflow enables the computation of the raster centerpoints, overall coverage, overall intensity and the difference in intensity or coverage between two raster layers, as well as the distance  between the centerpoints of the two input files (shift vector). The centerpoint is computed as the weighted average of raster cells inside the mask, overall coverage as the percentage of raster cells with values >0, overall intensity as the sum of all valued cells divided by the number of raster cells, and finally the shift vector as the distance between the centerpoints of the two input files using the Vincenty’s formulae. Summary statistics for the raster layers are also provided: number of raster cells, mean intensity, median, CV, SD, Min value, Max value and number of cells outside the mask.
</p>

<p>
This workflow store the computed difference image to the BioVeL Geoserver and create PNG overwiews contains the input and output files and the distribution points. The difference result image could be shown in the BioSTIF web visualisation client
</p>

<p>
The workflow contains the computation methods:
</p>

<p>
- Computation of the difference layer:
</p>

<p>
difference = inputfile_B - inputfile_A
</p>

<p>
- Computation of the overall coverage and intensity
overall_coverage = ((ncell(x)-cellStats(x, 'countNA')-count(x,0))/(ncell(x)-cellStats(x, 'countNA')))*100 
overall_intensity = cellStats(x, sum)/(ncell(x)-cellStats(x, 'countNA')) 
</p>

<p>
- Used standard R functions:
</p>

<p>
cellStats: <a href="https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/cellStats.R?view=markup&amp;root=raster" rel="nofollow">https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/cellStats.R?view=markup&amp;root=raster</a>
</p>

<p>
The PNG overview will be created with these values (corresponding to the Geoserver style)
ERDASImagine file:
</p>

<p>
breakpoints = c(0,1,25,50,75,100)
GeoTIFF file
breakpoints = c(0,2,63,127,190,254)
colors =  c(rgb(1.0,1.0,1.0), rgb(0.996,0.898,0.851), rgb(0.988,0.682,0.569), rgb(0.984,0.416,0.290), rgb(0.871,0.176,0.149), rgb(0.647,0.059,0.082))
</p>

<p>
Expected as input files are those raster images as a URL reference e.g. output files from openModeller created by an ENM workflow.
*A file upload into the workflow is not possible, only a reference to the input file as URL*
</p>

<p>
Supported formats are:
</p>

<p>
- ERDASImagine (.img) files with a value range 0 - 100, noData value 101
- GeoTIFF (.tif) files with a value range 0- 254, noData Value 255
</p>

<p>
Input files with a different extent will be intersected to a common extent and the current layer (inputfile 1) will be resampled to the prediction layer (inputfile 2) using the "nearest neighbor" sampling method.
</p>

<p>
The difference layer will be computed as inputfile_2 - inputfile_1
</p>

<p>
For working with the ESW in a own localhost an R instance should by installed on a own machine (<a href="http://cran.r-project.org/" rel="nofollow">http://cran.r-project.org/</a>). For the computation the followed extensions must be installed: rgdal, raster and rserve. Rserve must be started before the computation.
</p>

<p>
--------------------
</p>

<p>
This workflow has been created by the Biodiversity Virtual e-Laboratory (BioVeL <a href="http://www.biovel.eu/" rel="nofollow">http://www.biovel.eu/</a>) project. BioVeL is funded by the EU’s Seventh Framework Program, grant no. 283359.
</p>


    </div>


      <h3>
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This section shows the preview of this version of the Workflow (click on the image to expand)] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Preview
      </h3>

      

          <div class="contribution_preview" style="width: 100%;">
            <p style="text-align: center">
              <a href="/workflows/3647/versions/16/previews/full" onclick="window.open(this.href);return false;"><img alt="Medium" src="/workflows/3647/versions/16/previews/medium" /></a>
            </p>
            
                <p style="text-align: right; color: #666666;">
                  <a href="/workflows/3647/versions/16/previews/svg">Download as scalable diagram (SVG)</a>
                </p>
            

            
          </div>
      



      <h3>
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This section provides options for running this version of the Workflow] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Run
      </h3>

      
          
              <div style="margin: 0 0.5em;">
	<h4>
		Run this Workflow in the Taverna Workbench...
	</h4>
	
	<div class="option_box">
		
		<p style="text-align: center;">
			<b>Option 1:</b>
		</p>
		
		<p style="font-size: 93%; text-align: center;">
			Copy and paste this link into File > 'Open workflow location...'<br/>
			<a href="http://www.myexperiment.org/workflows/3647/download?version=16">http://www.myexperiment.org/workflows/3647/download?version=16</a><br/>
			<small>[ <a href="#" onclick="Effect.toggle(&quot;run_taverna_more_box&quot;,'blind',{duration:0.3});; return false;">More Info<img alt="Expand" src="/images/folds/unfold.png?1680607579" style="margin-left: 0.3em; vertical-align: middle;" /></a> ]</small>
		</p>
		
		<div id="run_taverna_more_box" style="display: none;">
			<p style="font-size: 85%; margin-top: 0.5em; text-align: center;">
				Taverna is available from <a href="http://taverna.sourceforge.net/" onclick="window.open(this.href);return false;">http://taverna.sourceforge.net/</a>
			</p>
			
			<p style="text-align: center; margin-top: 0.5em; font-size: 85%;">
				If you are having problems downloading it in Taverna, you may need to provide your username and password in the URL so that Taverna can access the Workflow: <br/>
				
					<b>Replace <font color="#990000">http://</font> in the link above with <font color="#990000">http://yourusername:yourpassword@</font></b>
				
			</p>
		</div>
	
	</div>
</div>


          
      

      <br/>

      <h3>
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This section shows the internal components of this workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Workflow Components
      </h3>

      
          
              
	    <!-- Authors -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This is the author information extracted from the workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Authors (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
                          <tr>
                <td>Yuliya Fetyukova, Francisco Quevedo, Sarah Bourlat, Robert Kulawik </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Titles -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[These are the descriptive titles embedded within the workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Titles (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
                          <tr>
                <td>BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</td>
              </tr>
            
          </table>
        
      </div>
    </div>

    <!-- Descriptions -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[These are the descriptions embedded within the workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Descriptions (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
                          <tr>
                <td>The ENM Statistical Difference Workflow (ESW DIFF) allows the computation of the extent and intensity of change in species potential distribution through computation of the differences between two raster layers using the R statistical environment (R Core Team 2013). The difference file is computed from two input files (in this case present projection and 2050 projection) coming from the Ecological Niche Modelling (ENM) Workflow (http://www.myexperiment.org/workflows/3355).

The difference between each corresponding raster cell value is computed and stored in the difference file, regardless of the input files’ geographical extent and origin. If the files have a different geographical extent and/or origin the raster-diff workflow automatically crops them to the same extent and resamples the values using the “nearest neighbour” method, resulting in a perfect cell match between the two rasters. The resulting value in the difference file ranges from the negative and positive maximum values of the input files to represent the maximum possible change in both directions. 


The diff result values are classified into six positive and negative classes. The predicted differences are presented for each species as a heat map, where cells with colors from green to red indicate an increase and from green to blue a decrease of predicted potential for a species. The workflow enables the computation of the raster centerpoints, overall coverage, overall intensity and the difference in intensity or coverage between two raster layers, as well as the distance  between the centerpoints of the two input files (shift vector). The centerpoint is computed as the weighted average of raster cells inside the mask, overall coverage as the percentage of raster cells with values &gt;0, overall intensity as the sum of all valued cells divided by the number of raster cells, and finally the shift vector as the distance between the centerpoints of the two input files using the Vincenty’s formulae. Summary statistics for the raster layers are also provided: number of raster cells, mean intensity, median, CV, SD, Min value, Max value and number of cells outside the mask.


This workflow store the computed difference image to the BioVeL Geoserver and create PNG overwiews contains the input and output files and the distribution points. The difference result image could be shown in the BioSTIF web visualisation client

The workflow contains the computation methods:

- Computation of the difference layer:
difference = inputfile_B - inputfile_A

- Computation of the overall coverage and intensity
overall_coverage = ((ncell(x)-cellStats(x, &#39;countNA&#39;)-count(x,0))/(ncell(x)-cellStats(x, &#39;countNA&#39;)))*100 
overall_intensity = cellStats(x, sum)/(ncell(x)-cellStats(x, &#39;countNA&#39;)) 

- Used standard R functions:
cellStats: https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/cellStats.R?view=markup&amp;root=raster

The PNG overview will be created with these values (corresponding to the Geoserver style)
ERDASImagine file:
breakpoints = c(0,1,25,50,75,100)
GeoTIFF file
breakpoints = c(0,2,63,127,190,254)
colors =  c(rgb(1.0,1.0,1.0), rgb(0.996,0.898,0.851), rgb(0.988,0.682,0.569), rgb(0.984,0.416,0.290), rgb(0.871,0.176,0.149), rgb(0.647,0.059,0.082))

Expected as input files are those raster images as a URL reference e.g. output files from openModeller created by an ENM workflow.
*A file upload into the workflow is not possible, only a reference to the input file as URL*

Supported formats are:
- ERDASImagine (.img) files with a value range 0 - 100, noData value 101
- GeoTIFF (.tif) files with a value range 0- 254, noData Value 255

Input files with a different extent will be intersected to a common extent and the current layer (inputfile 1) will be resampled to the prediction layer (inputfile 2) using the &quot;nearest neighbor&quot; sampling method.

The difference layer will be computed as inputfile_2 - inputfile_1

For working with the ESW in a own localhost an R instance should by installed on a own machine (http://cran.r-project.org/). For the computation the followed extensions must be installed: rgdal, raster and rserve. Rserve must be started before the computation.

--------------------

This workflow has been created by the Biodiversity Virtual e-Laboratory (BioVeL http://www.biovel.eu/) project. BioVeL is funded by the EU’s Seventh Framework Program, grant no. 283359.</td>
              </tr>
            
          </table>
        
      </div>
    </div>
        
    <!-- Dependencies -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[These are the listed dependencies of the workflow] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Dependencies (0)
      </div>
      <div class="foldContent" style="display: none;">
        
          <p class="none_text">None</p>
        
      </div>
    </div>
        
    <!-- Sources -->
        <div class="fold">
      <div class="foldTitle">
        Inputs (6)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
          
                          <tr>
                <td><b>input1</b></td>
                <td>
                  
                    
                      Input of the current layer. The difference will be computed as predictionLayer  - currentLayer

Expected as input files are raster images as a URL from openModeller created by an ENM workflow. A file upload is not possible!

Supported formats are:
- ERDASImagine (.img) files with a value range 0 - 100, noData value 101
- GeoTIFF (.tif) files with a value range 0 - 254, noData Value 255

Input files with a different extent will be intersected to a common extent and the current layer (inputfile 1) will be resampled to the prediction layer (inputfile 2) using the &quot;nearest neighbour&quot; sampling method                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>input2</b></td>
                <td>
                  
                    
                      Input of the prediction layer. The difference will be computed as predictionLayer  - currentLayer

Expected as input files are raster images as a URL from openModeller created by an ENM workflow. A file upload is not possible!

Supported formats are:
- ERDASImagine (.img) files with a value range 0 - 100, noData value 101
- GeoTIFF (.tif) files with a value range 0 - 254, noData Value 255

Input files with a different extent will be intersected to a common extent and the current layer (inputfile 1) will be resampled to the prediction layer (inputfile 2) using the &quot;nearest neighbor&quot; sampling method                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>label_species</b></td>
                <td>
                  
                    
                      Enter your favorite name for the species used in the &quot;changes&quot; output table only                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>PNG_output_size</b></td>
                <td>
                  
                    
                      Size of the output PNG&#39;s in pixels.                       
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>occurrence_csv</b></td>
                <td>
                  
                    
                      URL to the CSV File with occurrence points coming from ENM.

If you don&#39;t want to display any points, type  &quot;none&quot; at the begin,

else paste a CSV URL or the content from a CSV or a CSV file as input

Example CSV URL:
http://biovel.github.io/esw/sample_data/dendrolimus_pini.csv                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>center_of_mass</b></td>
                <td>
                  
                    
                      Enter false or true.
If you want to display centers of mass on the layers type &quot;true&quot;.                      
                    
                  
                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
      
    <!-- Processors -->
        <div class="fold">
      <div class="foldTitle">
        Processors (2)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          
                          <tr>
                <td><b>Rshell</b></td>
                <td>rshell</td>
                <td>
                                    <div><h3>Script</h3><pre>#------------------------------
#load required libraries, they must be installed on the R instnce
#-------------------------------------------------
library(rgdal)
library(raster)
library(SDMTools)

#-------------------------------------------------
#create unique names with a timestamp (Sys.time)
#-------------------------------------------------
creation_time <- Sys.time()
dest <- as.numeric(creation_time)
destname1 <- paste(dest, '_x_raster', sep="") 
destname2 <- paste(dest, '_y_raster', sep="")
csv_name <- paste(dest, 'csv', sep="")

#---------------------------------------
#files download
#-------------------------------------------------
if(isTRUE(toString(Sys.info()['sysname'])=="Windows")){	
   # windows download
   download.file(url=in1, destfile=destname1, method = "internal",mode="wb", quiet=FALSE)
   download.file(url=in2, destfile=destname2, method = "internal",mode="wb", quiet=FALSE)
} else {
   #linux-mac download
   download.file(url=in1, destfile=destname1, method = "auto", quiet=FALSE)
   download.file(url=in2, destfile=destname2, method = "auto", quiet=FALSE)
}

#download and unzip the shapefile
shapeDownload <- "OK"
tmpDir <- tempdir()
shapeDir <- paste(tmpDir,"tdwg_level_4.shp",sep='/')
if(!isTRUE(file.exists(shapeDir))){
   shapeDownload <- "file download"
   url <- "http://biovel.github.io/esw/tdwg_level_4.zip"
   file <- basename(url)
   download.file(url, file)
   unzip(file, exdir = tmpDir )	
}
shapeFile <- readOGR(tmpDir,"tdwg_level_4")

#download and read the CSV occurence points
displayPoints <- FALSE
if(!is.na(pmatch('http',csv_url))){
   download.file(url=csv_url, destfile=csv_name, method = "auto", quiet=FALSE)
   pts<-data.frame()
   pts<-read.csv(csv_name, sep=",", header = T)
   coordinates(pts) <- c("decimalLongitude", "decimalLatitude")
   displayPoints <- TRUE
} else if(!is.na(pmatch('none',csv_url))){
   displayPoints <- FALSE
} else {
   pts<-data.frame()
   con <- textConnection(csv_url)
   pts<-read.csv(con, sep=",", header = T)
   close(con)
   coordinates(pts) <- c("decimalLongitude", "decimalLatitude")
   displayPoints <- TRUE
}

#-------------------------------------------------
#variables
#-------------------------------------------------
normalize <- FALSE
normalizeBoth <- FALSE
#I can't get the really max values, only the current values from the rasterimage
enm_tif_max <- as.numeric(254.0)
enm_img_max <- as.numeric(100.0)
novalue <- FALSE
diffxy <- tempfile()
rx_normalized <- tempfile()
ry_normalized <- tempfile()
cropped <- FALSE
output_format <- "HFA"
size <- as.integer(png_size)

#-------------------------------------------------
#read the images
#-------------------------------------------------
x <- readGDAL(destname1)
y <- readGDAL(destname2)
# and convert to raster
rx <- raster(x)
ry <- raster(y)

#-------------------------------------------------
#read raster values values from GDALinfo
#-------------------------------------------------
#GDALinfo
gi1 <- GDALinfo(destname1)
gi2 <- GDALinfo(destname2)
#check the datatype, only "Byte" with a valueRange from 0 - 255 is allowed
#TODO: check to work with other datatypes, when they are different, normalize to 100 or to 1

#get the datatype from GDALinfo
dataType1 <- toString(attributes(gi1)$df[,1])
dataType2 <- toString(attributes(gi2)$df[,1])
#STOP if the data type is not Byte
if(!isTRUE((dataType1 == "Byte")&&(dataType2 == "Byte"))){
   stop("one of the input files is not a 'Byte' datatype. Currently are only 'Byte' datatypes allowed")	
}
#get GDAL raster driver
driver1 <- attributes(gi1)$driver# <- HFA or GTiff
driver2 <- attributes(gi2)$driver# <- HFA or GTiff
#check wheather the input files are IMG or TIFF
if(!((isTRUE(driver1 == "HFA") || isTRUE(driver1 == "GTiff")) &&(isTRUE(driver2 == "HFA") || isTRUE(driver2 == "GTiff")))){
   stop("one of the input files is not a IMG or GeoTIFF file")	
}
#check if the driver is GTiff or different drivers and hat to be normalized the maxvalue to 100
if(isTRUE(driver1 == "GTiff") && isTRUE(driver2 == "GTiff")){
   normalizeBoth <- TRUE
   rx_normalized <- (rx/enm_tif_max)*100	
   ry_normalized <- (ry/enm_tif_max)*100	
} else if(!isTRUE(driver1 == driver2)){
   #in case of mix mode HFA and GTiff
   normalize <- TRUE
   if(isTRUE(driver1 == "GTiff")){
     rx_normalized <- (rx/enm_tif_max)*100	
   }else{
     rx_normalized <- rx
   }
   if(isTRUE(driver2 == "GTiff")){
     ry_normalized <- (ry/enm_tif_max)*100	
   }else{
     ry_normalized <- ry
   }
} else {
   rx_normalized <- rx
   ry_normalized <- ry	
}

#get noData value from GDALinfo
#novalue1 <- paste(attributes(gi1)$df[,3],".0",sep="")
novalue1 <- attributes(gi1)$df[,3]
novalue2 <- attributes(gi2)$df[,3]
if(isTRUE(normalize)){
   novalue <- as.numeric(101.0)
} else if(isTRUE(novalue1==novalue2)){
   novalue <- as.numeric(novalue1)
} else {
   stop("something is wrong with noData values in both files - noData values are different")	
}

#-------------------------------------------------
#intersect both layers => create new layers with a common extent and resample the files if the origin or extent is different, else error
#-------------------------------------------------
if(!isTRUE((origin(rx)==origin(ry))&&(extent(rx)==extent(ry)) )){
   cropped <- TRUE
   is <- intersect(rx, ry)
   rx <-crop (rx, is)
   ry <-crop (ry, is)
   #resample rx to ry to get the same origin
   rx <- resample(rx, ry, method="ngb")
 
   if(isTRUE(normalize) || isTRUE(normalizeBoth)){
     rx_normalized <-crop (rx_normalized, is)
     ry_normalized <-crop (ry_normalized, is)
     #resample rx to ry to get the same origin
     rx_normalized <- resample(rx_normalized, ry_normalized, method="ngb")
   }
}

#-------------------------------------------------
#diff from raster rx and raster ry -> 
#-------------------------------------------------
if(isTRUE(normalize)){
   diffxy <- ry_normalized - rx_normalized
}else {
   diffxy <- (ry-rx)	
}

#-------------------------------------------------
#Centre of Gravity or Mass calculations for spatial data 
#-------------------------------------------------
x_centre <- COGravity(rx) #or COGravity(x) 
y_centre <- COGravity(ry) #or COGravity(y)

x_COGx <- x_centre[1]
x_COGy <- x_centre[3]

y_COGx <- y_centre[1]
y_COGy <- y_centre[3]

if (x_COGx != y_COGx || x_COGy!=y_COGy){
   distance_shift <- SDMTools::distance(x_COGy, x_COGx, y_COGy, y_COGx, bearing=TRUE)
   dist_km <- distance_shift[1,5]/1000  
}else {
   dist_km <- 0
}

displayMassPoints <- FALSE
if(!is.na(pmatch('true',center_of_mass))){
   displayMassPoints <- TRUE
}

#-------------------------------------------------
#for further computations and creating tables the "NA" values will be replaces with real NA values, 101 for HFA or 254 for GTiff
#-------------------------------------------------
NAvalue(rx) <- novalue
NAvalue(ry) <- novalue
NAvalue(diffxy) <- novalue
if(isTRUE(normalize)|| isTRUE(normalizeBoth)){
    NAvalue(rx_normalized) <- novalue
    NAvalue(ry_normalized) <- novalue
}

#-------------------------------------------------
#summary file with raster statistics
#-------------------------------------------------
sum1 <- paste("XX","ncell","mean","median","cv","sd","min","max","countNA",sep = ",")
if(isTRUE(normalize)){
   sum2 <- paste("currentLayer",ncell(rx_normalized),cellStats(rx_normalized, stat='mean', na.rm=TRUE),cellStats(rx_normalized, median),cellStats(rx_normalized,cv),cellStats(rx_normalized, stat='sd'),cellStats(rx_normalized,stat='min'),cellStats(rx_normalized, stat='max'),cellStats(rx_normalized, stat='countNA'),sep=",")
   sum3 <- paste("predictionLayer",ncell(ry_normalized),cellStats(ry_normalized, stat='mean', na.rm=TRUE),cellStats(ry_normalized, median),cellStats(ry_normalized,cv),cellStats(ry_normalized, stat='sd'),cellStats(ry_normalized, stat='min'),cellStats(ry_normalized, stat='max'),cellStats(ry_normalized, stat='countNA'),sep=",")
   sum4 <- paste("diffLayer",ncell(diffxy),cellStats(diffxy, stat='mean', na.rm=TRUE),cellStats(diffxy, median),cellStats(diffxy, cv),cellStats(diffxy, stat='sd'),cellStats(diffxy,stat='min'),cellStats(diffxy, stat='max'),cellStats(diffxy, stat='countNA'), sep=",")
} else{
   sum2 <- paste("currentLayer",ncell(rx),cellStats(rx, stat='mean', na.rm=TRUE),cellStats(rx, median),cellStats(rx,cv),cellStats(rx, stat='sd'),cellStats(rx,stat='min'),cellStats(rx, stat='max'),cellStats(rx, stat='countNA'),sep=",")
   sum3 <- paste("predictionLayer",ncell(ry),cellStats(ry, stat='mean', na.rm=TRUE),cellStats(ry, median),cellStats(ry,cv),cellStats(ry, stat='sd'),cellStats(ry,stat='min'),cellStats(ry, stat='max'),cellStats(ry, stat='countNA'),sep=",")
   sum4 <- paste("diffLayer",ncell(diffxy),cellStats(diffxy, stat='mean', na.rm=TRUE),cellStats(diffxy, median),cellStats(diffxy, cv),cellStats(diffxy, stat='sd'),cellStats(diffxy,stat='min'),cellStats(diffxy, 'max'),cellStats(diffxy, stat='countNA'), sep=",")
}
rastersummary <- paste(sum1, sum2, sum3, sum4, sep = "\n")


#-------------------------------------------------
#compute overall statistics
#-------------------------------------------------

#NOTE count value -> count(rx,0) is deprecated in R version >3
#use freq instead
count_zero_rx <- 0
count_zero_ry <- 0

if(isTRUE(toString(version["major"][1]) == 2)){
   # for R version 2
   count_zero_rx <- count(rx,0)
   count_zero_ry <- count(ry,0)
} else {
   #for R version 3+
   count_zero_rx <- as.numeric(toString(freq(rx)[1,"count"]))
   count_zero_ry <- as.numeric(toString(freq(ry)[1,"count"]))
}

#compute overall cover
overall_coverX <- ((ncell(rx)-cellStats(rx, 'countNA')-count_zero_rx)/(ncell(rx)-cellStats(rx, 'countNA')))*100
overall_coverY <- ((ncell(ry)-cellStats(ry, 'countNA')-count_zero_ry)/(ncell(ry)-cellStats(ry, 'countNA')))*100

#compute overall intensity
overall_intensityX <- (cellStats(rx, sum)/(ncell(rx)-cellStats(rx, 'countNA')))
overall_intensityY <- (cellStats(ry, sum)/(ncell(ry)-cellStats(ry, 'countNA')))
diff_intensity <- overall_intensityY - overall_intensityX 

#compute nomalized intensity to have comperable values in percent
diff_intensity_normalized <- tempfile()
if(isTRUE(normalize) || isTRUE(normalizeBoth)){
   overall_intensityX_normalized <- (cellStats(rx_normalized, sum)/(ncell(rx_normalized)-cellStats(rx_normalized, 'countNA')))
   overall_intensityY_normalized <- (cellStats(ry_normalized, sum)/(ncell(ry_normalized)-cellStats(ry_normalized, 'countNA')))
} else {
   overall_intensityX_normalized <- overall_intensityX
   overall_intensityY_normalized <- overall_intensityY	
}
diff_intensity_normalized <- overall_intensityY_normalized - overall_intensityX_normalized

changes1 <- paste("XX","Overall coverage","Overall coverage","Difference overall coverage","Overall intensity (absolute) ","Overall intensity (absolute)","Difference overall intensity (absolute)","Overall intensity (percentage)","Overall intensity (percentage)","Difference overall intensity (percentage)","Mass centre longitude","Mass centre latitude","Mass centre longitude","Mass centre latitude","Shift distance", sep=",")
changes2 <- paste("species","current","prediction","prediction-current","current","prediction","prediction-current","current_%","prediction_%","prediction-current_%","current","current","prediction","prediction","km", sep=",")
changes3 <- paste(label,overall_coverX,overall_coverY,overall_coverY-overall_coverX,overall_intensityX,overall_intensityY,diff_intensity,overall_intensityX_normalized,overall_intensityY_normalized,diff_intensity_normalized,x_centre[1],x_centre[3],y_centre[1],y_centre[3],dist_km,sep=",")
changes <- paste(changes1,changes2,changes3, sep = "\n")


#-------------------------------------------------
#export of PNG overviews
#-------------------------------------------------
getAsp <- function(rasterObj) {
   if (raster:::.couldBeLonLat(rasterObj, warnings=FALSE)){ 
     ym_rasterObj <- mean(c(ymax(rasterObj), ymin(rasterObj)))
     asp <- 1/cos((ym_rasterObj * pi)/180) 
   } else { 
     asp <- 1 
   }
   asp
}

#print current layer
png(filename=currentLayerPng,height=size, width=size, bg="white")
cols <- c(rgb(1.0,1.0,1.0),rgb(0.996,0.898,0.851),rgb(0.988,0.682,0.569),rgb(0.984,0.416,0.290),rgb(0.871,0.176,0.149),rgb(0.647,0.059,0.082))
if(isTRUE(normalizeBoth)){
   breakpoints <- c(0,2,63,127,190,254)
}else{
   breakpoints <- c(0,1,25,50,75,100)
}
if(isTRUE(normalize)){
   plot(rx_normalized ,breaks=breakpoints,col=cols, alpha=0.7, asp=getAsp(rx), maxpixels=size^2)
} else {
   plot(rx ,breaks=breakpoints,col=cols, alpha=0.7, asp=getAsp(rx), maxpixels=size^2)
}
plot(shapeFile, add=TRUE)
if(isTRUE(displayPoints)){
   points(coordinates(pts),col = "black", bg = "yellow",pch = 21)
}

if(isTRUE(displayMassPoints)){
  points(x_COGx,x_COGy,col = "black", bg = "green",pch = 21, cex = 1.5)
  title(main='currentLayer, Centre of Mass')
  #points(y_COGx,y_COGy,col = "black", bg = "blue",pch = 21)
} else {
  title(main='currentLayer')	
}
dev.off()

#print prediction layer
png(filename=predictionLayerPng,height=size, width=size, bg="white")
if(isTRUE(normalize)){
   plot(ry_normalized ,breaks=breakpoints,col=cols, alpha=0.7, asp=getAsp(rx), maxpixels=size^2)
} else {
   plot(ry ,breaks=breakpoints,col=cols, alpha=0.7, asp=getAsp(rx), maxpixels=size^2)
}
plot(shapeFile, add=TRUE)
if(isTRUE(displayPoints)){
   points(coordinates(pts),col = "black", bg = "yellow",pch = 21)
}

if(isTRUE(displayMassPoints)){
   points(y_COGx,y_COGy,col = "black", bg = "green",pch = 21, cex = 1.5)
   title(main='predictionLayer, Centre of Mass')
} else {
   title(main='predictionLayer')	
}
dev.off()

#print diff layer
png(filename=diffLayerPng,height=size, width=size, bg="white")
if(isTRUE(normalizeBoth)){
   breakpoints_diff <- c(-254,-190,-127,-63,-2,2,63,127,190,254)
}else{
   breakpoints_diff <- c(-100,-70,-50,-25,-1,1,25,50,70,100)
}
cols_diff <- c(rgb(0.396,0.310,0.635),rgb(0.196,0.533,0.741),rgb(0.4,0.761,0.647),rgb(0.671,0.867,0.643),rgb(1.0,1.0,1.0),rgb(0.992,0.682,0.380),rgb(0.957,0.427,0.263),rgb(0.835,0.243,0.310),rgb(0.620,0.004,0.259))
#plot(diffxy,breaks=breakpoints_diff,col=cols_diff, alpha=0.7) #main='diffLayer',
plot(diffxy,breaks=breakpoints_diff,col=cols_diff, alpha=0.7, asp=getAsp(rx), maxpixels=size^2)
plot(shapeFile, add=TRUE)
if(isTRUE(displayPoints)){
   points(coordinates(pts),col = "black", bg = "yellow",pch = 21)
}

if(isTRUE(displayMassPoints)){
   points(x_COGx,x_COGy,col = "black", bg = "green",pch = 21,cex = 1.5) #cex = 0.5
   points(y_COGx,y_COGy,col = "black", bg = "green",pch = 21,cex = 1.5)
   arrows(x_COGx, x_COGy, y_COGx, y_COGy, col = "red", lwd=3)
   title(main='diffLayer, Shift Vector')
} else {
   title(main='diffLayer')	
}
dev.off()


#-------------------------------------------------
#store files
#-------------------------------------------------
#store input raster in a table/Arcgrid format

## NOTE: the usage of the ARCGRID format is necessary because it is only possible to pass text files between Taverna
## workflowas, any other files will be stringified and damaged
if(isTRUE(normalize)){
   writeRaster(rx_normalized, filename='x_matrix.asc', format="ascii", overwrite=TRUE)
		file.rename('x_matrix.asc','x_matrix.png')
   writeRaster(ry_normalized, filename='y_matrix.asc', format="ascii", overwrite=TRUE)
		file.rename('y_matrix.asc','y_matrix.png')
	
}else {
   writeRaster(rx, filename='x_matrix.asc', format="ascii", overwrite=TRUE)
		file.rename('x_matrix.asc','x_matrix.png')
   writeRaster(ry, filename='y_matrix.asc', format="ascii", overwrite=TRUE)
		file.rename('y_matrix.asc','y_matrix.png')
}

#store diffresult as a TIFF/IMG file and a Arcgrid file
if(isTRUE(normalizeBoth)){
   output_format <- "GTiff"
   writeRaster(diffxy, filename='diffImg.tif', format="GTiff", overwrite=TRUE)
		file.rename('diffImg.tif','diffImg.png')
} else {
   output_format <- "HFA"
   writeRaster(diffxy, filename='diffImg.img', format="HFA", overwrite=TRUE)
		file.rename('diffImg.img','diffImg.png')	
}
writeRaster(diffxy, filename='diffascii.asc', format="ascii", overwrite=TRUE)
#write.asciigrid(rep_diff, fname='diffascii.asc',na.value = novalue)
file.rename('diffascii.asc','diffascii.png')


#-------------------------------------------------
#write logfile with process informations
#-------------------------------------------------
log_date <- paste("computation start: ",creation_time, sep="")
inFile1 <-tempfile()
values_in1 <- tempfile()
values_in1_norm <- tempfile()
inFile2 <-tempfile()
values_in2 <- tempfile()
values_in2_norm <- tempfile()
outFile <-tempfile()
values_out <- tempfile()
isCropped <- tempfile()
isNormalized <- tempfile()

if(driver1=="HFA"){
   inFile1 <- 'File 1 input format: ERDASImagine (.img)'
   values_in1 <- paste("value range: 0 <> 100, noData 101, current values: min ",cellStats(rx,'min'), ", max: ", cellStats(rx,'max'),sep="")
   values_in1_norm <- ""
}else{
   inFile1 <- 'File 1 input format: GeoTIFF (.tif)'
   values_in1 <- paste("value range: 0 <> 254, noData 255, current values: min ",cellStats(rx,'min'), ", max: ", cellStats(rx,'max'),sep="")

   if(isTRUE(normalize)){
      values_in1_norm <- paste("value range normalized: 0 - 100 , noData 101, current values: min ",cellStats(rx_normalized,'min'), " max: ", cellStats(rx_normalized,'max'),sep="")	
   } else {
      values_in1_norm <- ""
   }
}
if(driver2=="HFA"){
   inFile2 <- 'File 2 input format: ERDASImagine (.img)'
   values_in2 <- paste("value range: 0 <> 100, noData 101, current values: min ",cellStats(ry,'min'), ", max: ", cellStats(ry,'max'),sep="")
   values_in2_norm <- ""
}else{
   inFile2 <- 'File 2 input format: GeoTIFF (.tif)'
   values_in2 <- paste("value range: 0 <> 254, noData 255, current values: min ",cellStats(ry,'min'), ", max: ", cellStats(ry,'max'),sep="")

   if(isTRUE(normalize)){
      values_in2_norm <- paste("value range normalized: 0 - 100 , noData 101, current values: min ",cellStats(ry_normalized,'min'), ", max: ", cellStats(ry_normalized,'max'),sep="")	
   } else {
      values_in2_norm <- ""
   }
}
if (isTRUE(normalizeBoth)){
   outFile <- "output file format: GeoTIFF (.tif)"
   values_out <- paste("value range: -254 <> 254, noData: 255, current values: min ",cellStats(diffxy,'min'), ", max: ", cellStats(diffxy,'max'),sep="")
} else {
   outFile <- "output file format: ERDASImagine (.img)"
   values_out <- paste("value range: -100 <> 100, noData: 101, current values: min ",cellStats(diffxy,'min'), ", max: ", cellStats(diffxy,'max'),sep="")
}

if (isTRUE(cropped)){
   isCropped <- "input files cropped: YES"
} else {
   isCropped <- "input files cropped: NO"
}

if (isTRUE(normalize)){
   isNormalized <- "input files nomalized: YES"
} else {
   isNormalized <- "input files normalized: NO"
}
logfile <- paste("---------------",log_date,"------", inFile1, values_in1, values_in1_norm,"------", inFile2, values_in2, values_in2_norm,"------", isCropped, isNormalized,"------", outFile, values_out,"-----","point display", displayPoints, sep="\n")
</pre></div><div><h3>R Server</h3>localhost:6311</div>                </td>
              </tr>
                          <tr>
                <td><b>parse_csv</b></td>
                <td>beanshell</td>
                <td>
                                    <div><h3>Script</h3><pre>import java.io.StringReader;
import java.io.BufferedReader;

BufferedReader reader = new BufferedReader(new StringReader(csv_content));

    String temp = null;
    StringBuffer text = new StringBuffer();
    while ((temp = reader.readLine()) != null) {
            text.append(temp + "\n");

    };

String csv_string = text.toString().substring(0,text.toString().length()-1);
</pre></div>                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Beanshells -->
        <div class="fold">
      <div class="foldTitle">
        Beanshells (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th>Inputs</th>
              <th>Outputs</th>
            </tr>
          
                          <tr>
                <td><b>parse_csv</b></td>
                <td></td>
                <td>
                  
                    
                      csv_content                      
                    
                  
                </td>
                <td>
                  
                    
                      csv_string                      
                    
                  
                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Sinks -->
        <div class="fold">
      <div class="foldTitle">
        Outputs (10)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
          
                          <tr>
                <td><b>summary</b></td>
                <td>
                  
                    
                      This file contains the summary for the current, prediction and the difference layer:
- Number of cells (ncell),
- Mean and median value (mean,median)
- Coefficient of variation (cv)
- Standard deviation (sd)
- current minimal and maximal values (min,max)
- Number of noData values in file (countNA)                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>currentLayerPng</b></td>
                <td>
                  
                    
                      PNG overview of the input current layer with a background country borders based on the TDWG level4 layer 

Used color ramp:
ERDASImagine file:
breakpoints = (0,1,25,50,75,100)
GeoTIFF file
breakpoints = c(0,2,63,127,190,254)
colors = c(rgb(1.0,1.0,1.0),rgb(0.996,0.898,0.851),rgb(0.988,0.682,0.569),rgb(0.984,0.416,0.290),rgb(0.871,0.176,0.149),rgb(0.647,0.059,0.082))                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>predictionLayerPng</b></td>
                <td>
                  
                    
                      PNG overview of the input prediction layer with a background country borders based on the TDWG level4 layer 

Used color ramp:
ERDASImagine file:
breakpoints = c(0,1,25,50,75,100)
GeoTIFF file
breakpoints = c(0,2,63,127,190,254)
colors =  c(rgb(1.0,1.0,1.0),rgb(0.996,0.898,0.851),rgb(0.988,0.682,0.569),rgb(0.984,0.416,0.290),rgb(0.871,0.176,0.149),rgb(0.647,0.059,0.082))                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>diffLayerPng</b></td>
                <td>
                  
                    
                      PNG overview of the output difference layer with a background country borders based on the TDWG level4 layer 

Used color ramp:
ERDASImagine file:
breakpoints = c(-100,-70,-50,-25,-1,1,25,50,70,100)
GeoTIFF file
breakpoints =  c(-254,-190,-127,-63,-2,2,63,127,190,254)
colors =  c(rgb(0.396,0.310,0.635),rgb(0.196,0.533,0.741),rgb(0.4,0.761,0.647),rgb(0.671,0.867,0.643),rgb(1.0,1.0,1.0),rgb(0.992,0.682,0.380),rgb(0.957,0.427,0.263),rgb(0.835,0.243,0.310),rgb(0.620,0.004,0.259))                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>changes</b></td>
                <td>
                  
                    
                      This file contains the changes computation in the submitted files:
Overall coverage in the input raster files and their difference
overall_coverage = ((ncell(x)-cellStats(x, &#39;countNA&#39;)-count(x,0))/(ncell(x)-cellStats(x, &#39;countNA&#39;)))*100 
difference = coverage_prediction - coverage_current

Overall intensity absolute and in percent and their difference
overall_intensity = (cellStats(x, sum)/(ncell(x)-cellStats(x, &#39;countNA&#39;)))
difference = intensity_prediction - intensity_current                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>diffImg</b></td>
                <td>
                  
                    
                      Image file of the difference layer, the format is the same as the input files: ERDASImagine or GeoTIFF                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>matrix_diff</b></td>
                <td>
                  
                    
                      Matrix table of the output raster file for the difference layer. The file is in ArcGRID format                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>logfile</b></td>
                <td>
                  
                    
                      This file contains a overview about the used files and the computation                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>matrix_x</b></td>
                <td>
                  
                    
                      Matrix table of the input raster file for the current layer. The file is in ArcGRID format                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>matrix_y</b></td>
                <td>
                  
                    
                      Matrix table of the input raster file for the prediction layer. The file is in ArcGRID format                      
                    
                  
                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Datalinks -->
        <div class="fold">
      <div class="foldTitle">
        Datalinks (17)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Source</th>
              <th>Sink</th>
            </tr>
          
                          <tr>
                <td>input1</td>
                <td>Rshell:in1</td>
              </tr>
                          <tr>
                <td>input2</td>
                <td>Rshell:in2</td>
              </tr>
                          <tr>
                <td>label_species</td>
                <td>Rshell:label</td>
              </tr>
                          <tr>
                <td>PNG_output_size</td>
                <td>Rshell:png_size</td>
              </tr>
                          <tr>
                <td>center_of_mass</td>
                <td>Rshell:center_of_mass</td>
              </tr>
                          <tr>
                <td>parse_csv:csv_string</td>
                <td>Rshell:csv_url</td>
              </tr>
                          <tr>
                <td>occurrence_csv</td>
                <td>parse_csv:csv_content</td>
              </tr>
                          <tr>
                <td>Rshell:rastersummary</td>
                <td>summary</td>
              </tr>
                          <tr>
                <td>Rshell:currentLayerPng</td>
                <td>currentLayerPng</td>
              </tr>
                          <tr>
                <td>Rshell:predictionLayerPng</td>
                <td>predictionLayerPng</td>
              </tr>
                          <tr>
                <td>Rshell:diffLayerPng</td>
                <td>diffLayerPng</td>
              </tr>
                          <tr>
                <td>Rshell:changes</td>
                <td>changes</td>
              </tr>
                          <tr>
                <td>Rshell:diffImg</td>
                <td>diffImg</td>
              </tr>
                          <tr>
                <td>Rshell:diffascii</td>
                <td>matrix_diff</td>
              </tr>
                          <tr>
                <td>Rshell:logfile</td>
                <td>logfile</td>
              </tr>
                          <tr>
                <td>Rshell:x_matrix</td>
                <td>matrix_x</td>
              </tr>
                          <tr>
                <td>Rshell:y_matrix</td>
                <td>matrix_y</td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Coordinations -->
        <div class="fold">
      <div class="foldTitle">
        Coordinations (0)
      </div>
      <div class="foldContent" style="display: none;">
        
          <p class="none_text">None</p>
        
      </div>
    </div>
  
    

          
      
    </div>

  </div>

</div>

<div class="contribution_right_box">
  <div class="contribution_section_box" style= "font-size: 100%; padding: 0.7em 0.9em; font-weight: bold;">
    <p><img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The type of workflow system that this Workflow is designed for.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" /> Workflow Type</p>
    <p><a href="/content_types/2">Taverna 2</a></p>
  </div>

  <div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The Uploader is the person who uploaded/created this Workflow on myExperiment, and who manages it on myExperiment.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Uploader
	</p>
	<p>
		<center>
			<div class="avatar" style="width: 66px">
  <a href="/users/20320"><img alt="Avatar" class="framed" height="60" src="/images/avatar.png?1680607579" title="Robert Kulawik" width="60" /></a>
  
	<span style="display:block;margin-top:2px;text-align:center;">
		
			<img alt="De" src="/images/famfamfam_flags/de.png?1680607579" style="vertical-align:middle; margin-right: 0.3em;" title="header=[] body=[&lt;b&gt;Location: &lt;/b&gt;Sankt Augustin, Germany] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		

    
			<a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
		

    
	</span>
  
</div>

		</center>
	</p>
</div>


  

  

<div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This specifies what rights users have when they download and use this Workflow.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		License
		<a name="license"></a>
	</p>

  

    
    
    
    
    


    

    <!--

    <rdf:RDF xmlns="http://creativecommons.org/ns#"
        xmlns:dc="http://purl.org/dc/elements/1.1/"
        xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
    <Work rdf:about="">
       <dc:title>BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</dc:title>
       <dc:date>2013-07-08 15:05:59 UTC</dc:date>
       <dc:description>&lt;p&gt;
The ENM Statistical Difference Workflow (ESW DIFF) allows the computation of the extent and intensity of change in species potential distribution through computation of the differences between two raster layers using the R statistical environment (R Core Team 2013). The difference file is computed from two input files (in this case present projection and 2050 projection) coming from the Ecological Niche Modelling (ENM) Workflow (&lt;a href=&quot;http://www.myexperiment.org/workflows/3355&quot; rel=&quot;nofollow&quot;&gt;http://www.myexperiment.org/workflows/3355&lt;/a&gt;).
&lt;/p&gt;

&lt;p&gt;
The difference between each corresponding raster cell value is computed and stored in the difference file, regardless of the input files’ geographical extent and origin. If the files have a different geographical extent and/or origin the raster-diff workflow automatically crops them to the same extent and resamples the values using the “nearest neighbour” method, resulting in a perfect cell match between the two rasters. The resulting value in the difference file ranges from the negative and positive maximum values of the input files to represent the maximum possible change in both directions. 
&lt;/p&gt;

&lt;p&gt;
The diff result values are classified into six positive and negative classes. The predicted differences are presented for each species as a heat map, where cells with colors from green to red indicate an increase and from green to blue a decrease of predicted potential for a species. The workflow enables the computation of the raster centerpoints, overall coverage, overall intensity and the difference in intensity or coverage between two raster layers, as well as the distance  between the centerpoints of the two input files (shift vector). The centerpoint is computed as the weighted average of raster cells inside the mask, overall coverage as the percentage of raster cells with values &gt;0, overall intensity as the sum of all valued cells divided by the number of raster cells, and finally the shift vector as the distance between the centerpoints of the two input files using the Vincenty’s formulae. Summary statistics for the raster layers are also provided: number of raster cells, mean intensity, median, CV, SD, Min value, Max value and number of cells outside the mask.
&lt;/p&gt;

&lt;p&gt;
This workflow store the computed difference image to the BioVeL Geoserver and create PNG overwiews contains the input and output files and the distribution points. The difference result image could be shown in the BioSTIF web visualisation client
&lt;/p&gt;

&lt;p&gt;
The workflow contains the computation methods:
&lt;/p&gt;

&lt;p&gt;
- Computation of the difference layer:
&lt;/p&gt;

&lt;p&gt;
difference = inputfile_B - inputfile_A
&lt;/p&gt;

&lt;p&gt;
- Computation of the overall coverage and intensity
overall_coverage = ((ncell(x)-cellStats(x, &#39;countNA&#39;)-count(x,0))/(ncell(x)-cellStats(x, &#39;countNA&#39;)))*100 
overall_intensity = cellStats(x, sum)/(ncell(x)-cellStats(x, &#39;countNA&#39;)) 
&lt;/p&gt;

&lt;p&gt;
- Used standard R functions:
&lt;/p&gt;

&lt;p&gt;
cellStats: &lt;a href=&quot;https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/cellStats.R?view=markup&amp;amp;root=raster&quot; rel=&quot;nofollow&quot;&gt;https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/cellStats.R?view=markup&amp;amp;root=raster&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
The PNG overview will be created with these values (corresponding to the Geoserver style)
ERDASImagine file:
&lt;/p&gt;

&lt;p&gt;
breakpoints = c(0,1,25,50,75,100)
GeoTIFF file
breakpoints = c(0,2,63,127,190,254)
colors =  c(rgb(1.0,1.0,1.0), rgb(0.996,0.898,0.851), rgb(0.988,0.682,0.569), rgb(0.984,0.416,0.290), rgb(0.871,0.176,0.149), rgb(0.647,0.059,0.082))
&lt;/p&gt;

&lt;p&gt;
Expected as input files are those raster images as a URL reference e.g. output files from openModeller created by an ENM workflow.
*A file upload into the workflow is not possible, only a reference to the input file as URL*
&lt;/p&gt;

&lt;p&gt;
Supported formats are:
&lt;/p&gt;

&lt;p&gt;
- ERDASImagine (.img) files with a value range 0 - 100, noData value 101
- GeoTIFF (.tif) files with a value range 0- 254, noData Value 255
&lt;/p&gt;

&lt;p&gt;
Input files with a different extent will be intersected to a common extent and the current layer (inputfile 1) will be resampled to the prediction layer (inputfile 2) using the &quot;nearest neighbor&quot; sampling method.
&lt;/p&gt;

&lt;p&gt;
The difference layer will be computed as inputfile_2 - inputfile_1
&lt;/p&gt;

&lt;p&gt;
For working with the ESW in a own localhost an R instance should by installed on a own machine (&lt;a href=&quot;http://cran.r-project.org/&quot; rel=&quot;nofollow&quot;&gt;http://cran.r-project.org/&lt;/a&gt;). For the computation the followed extensions must be installed: rgdal, raster and rserve. Rserve must be started before the computation.
&lt;/p&gt;

&lt;p&gt;
--------------------
&lt;/p&gt;

&lt;p&gt;
This workflow has been created by the Biodiversity Virtual e-Laboratory (BioVeL &lt;a href=&quot;http://www.biovel.eu/&quot; rel=&quot;nofollow&quot;&gt;http://www.biovel.eu/&lt;/a&gt;) project. BioVeL is funded by the EU’s Seventh Framework Program, grant no. 283359.
&lt;/p&gt;

</dc:description>
       <dc:creator><Agent>
          <dc:title><a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a></dc:title>
       </Agent></dc:creator>
       <dc:rights><Agent>
          <dc:title><a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a></dc:title>
       </Agent></dc:rights>
       <dc:type rdf:resource="http://purl.org/dc/dcmitype/Data" />
       <dc:source rdf:resource="http://www.myexperiment.org/workflows/3647.html"/>
       <license rdf:resource="http://creativecommons.org/licenses/by-sa/3.0/" />
    </Work>

    <License rdf:about="http://creativecommons.org/licenses/by-sa/3.0/">
      <permits rdf:resource="http://creativecommons.org/ns#Reproduction" />  <permits rdf:resource="http://creativecommons.org/ns#Distribution" />  <requires rdf:resource="http://creativecommons.org/ns#Notice" />  <requires rdf:resource="http://creativecommons.org/ns#Attribution" />  <permits rdf:resource="http://creativecommons.org/ns#DerivativeWorks" />  <requires rdf:resource="http://creativecommons.org/ns#ShareAlike" />
    </License>

    </rdf:RDF>

    -->

  

  <div class="contribution_currentlicense">
    <p>
      
        All versions of this Workflow are
      
      
        licensed under: <br/><br/><a rel="Copyright" href="/licenses/2" title="Creative Commons Attribution-Share Alike 3.0 Unported License"><img src="/images/by-sa.png" /></a>
      
    </p>
  </div>
	
</div>


  <script type="text/javascript">
    function showVersion(form) {
        var url = $("resource_versions").value;
        location.href = url;
        form.submit
    }
</script>
<style>
  .version_selection {
      font-size:smaller;
      text-align: center;
  }
</style>

<div class="contribution_section_box">
  <p class="heading">
    <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This box shows version 16 for this entry] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />    <span>Version 16 (latest)</span>
    <span class="count_text">(of 16)</span>
  </p>
  
      <form onsubmit="showVersion(this); return false;" style="text-align: right;">
        <p class="version_selection">
        View version:
        <select id="resource_versions" onchange="showVersion(this.form)">
          
              <option value="/workflows/3647/versions/16" selected>
                16 (latest)
              </option>
          
              <option value="/workflows/3647/versions/15" >
                15 
              </option>
          
              <option value="/workflows/3647/versions/14" >
                14 
              </option>
          
              <option value="/workflows/3647/versions/13" >
                13 
              </option>
          
              <option value="/workflows/3647/versions/12" >
                12 
              </option>
          
              <option value="/workflows/3647/versions/11" >
                11 
              </option>
          
              <option value="/workflows/3647/versions/10" >
                10 
              </option>
          
              <option value="/workflows/3647/versions/9" >
                9 
              </option>
          
              <option value="/workflows/3647/versions/8" >
                8 
              </option>
          
              <option value="/workflows/3647/versions/7" >
                7 
              </option>
          
              <option value="/workflows/3647/versions/6" >
                6 
              </option>
          
              <option value="/workflows/3647/versions/5" >
                5 
              </option>
          
              <option value="/workflows/3647/versions/4" >
                4 
              </option>
          
              <option value="/workflows/3647/versions/3" >
                3 
              </option>
          
              <option value="/workflows/3647/versions/2" >
                2 
              </option>
          
              <option value="/workflows/3647/versions/1" >
                1 (earliest)
              </option>
          
        </select>
        </p>
      </form>
  
</div>

  <div class="contribution_section_box">
	
	<p class="heading" style="margin-bottom: 0; padding-bottom: 0;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[Which people/groups get the credit for this Workflow?] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Credits <span class="count_text">(1)</span>
		<a name="credits"></a>
	</p>
	<span style="font-size: 85%; color: #666666; display: block; padding: 0.3em 0.5em 0 0.5em; margin: 0; line-height: 1em;">(People/Groups)</span>
	
		<div style="font-size: 85%;">
			<ul class="items">
				
					<li>
						
							
								<span class="icon"><img alt="User" src="/images/famfamfam_silk/user.png?1680607579" /> </span> 
							
							<a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
						
					</li>
				
			</ul>
		</div>
	
	
	
	<p class="heading" style="margin-bottom: 0; padding-bottom: 0;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[What other Workflows/Files is this one based on?] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Attributions <span class="count_text">(0)</span>
		<a name="attributions"></a>
	</p>
	<span style="font-size: 85%; color: #666666; display: block; padding: 0.3em 0.5em 0 0.5em; margin: 0; line-height: 1em;">(Workflows/Files)</span>
	
		<p class="none_text">None</p>
	
	
	
	
</div>


  


  <div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The tags for this Workflow entry.&lt;br/&gt;Note(1): if this Workflow has many versions, the tags apply to ALL versions in this entry.&lt;br/&gt;Note(2): the size of the tags show how popular they are on myExperiment.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Tags <span id="tags_box_header_tag_count_span" class="count_text">(12)</span>
		<a name="tags"></a>
	</p>

	<script type="text/javascript">
  function showAllTags() {
    Element.show('all_tags');
	  Element.hide('user_tags');
	  return false;
  }
  
  function showUsersTags() {
  	Element.hide('all_tags');
	  Element.show('user_tags');
	  return false;
  }
	
	function flip_tags_mode()
	{
		if( $('toggle_tags_mode').checked )
		  showUsersTags();
	  else
		  showAllTags();
	}
</script>

<div id="tags_inner_box">
	
		<div class="box_currentuser_specific" style="padding: 0.3em 0.2em; margin: 0.6em 0.4em;">
		  <label for="toggle_tags_mode" style="font-size: 85%; font-weight: bold;"><input id="toggle_tags_mode" name="toggle_tags_mode" onclick="flip_tags_mode();" style="margin-right: 0.3em;" type="checkbox" value="1" />Uploader tags</label>
		</div>
		<div id="all_tags">
			
				<div class="hTagcloud">
  <ul class="popularity">
    <li><a href='/tags/2991' class='vvvv-popular'>biovel</a></li>
<li> | </li>
    <li><a href='/tags/3160' class='popular'>ecological niche modelling</a></li>
<li> | </li>
    <li><a href='/tags/4390' class='popular'>heat map</a></li>
<li> | </li>
    <li><a href='/tags/602' class='vv-popular'>matrix</a></li>
<li> | </li>
    <li><a href='/tags/4393' class='popular'>occurrence data</a></li>
<li> | </li>
    <li><a href='/tags/750' class='v-popular'>r</a></li>
<li> | </li>
    <li><a href='/tags/4391' class='popular'>raster cell count</a></li>
<li> | </li>
    <li><a href='/tags/4388' class='popular'>raster difference</a></li>
<li> | </li>
    <li><a href='/tags/4392' class='popular'>raster layer</a></li>
<li> | </li>
    <li><a href='/tags/4389' class='popular'>resampling</a></li>
<li> | </li>
    <li><a href='/tags/721' class='popular'>species</a></li>
<li> | </li>
    <li><a href='/tags/1231' class='popular'>statistics</a></li>
  </ul>
</div>

			
		</div>
		<div id="user_tags"  style="display: none;">
			
    		<p class="none_text">None</p>
			
		</div>
	
</div>
	
	
	
	
		<p><small><b><a href="/session/new">Log in</a></b> to add Tags</small></p>
	
</div>


  
<div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[All the Groups that this item has been shared with] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Shared with Groups <span class="count_text">(2)</span>
	</p>
	
		<div style="font-size: 85%;">
			<ul class="items">
				
					<li>
						<span class="icon"><img alt="Network-member" src="/images/famfamfam_silk/group.png?1680607579" /> </span>
						<a href="/groups/1013">BioVeL internal</a>
					</li>
				
					<li>
						<span class="icon"><img alt="Network-member" src="/images/famfamfam_silk/group.png?1680607579" /> </span>
						<a href="/groups/643">BioVeL</a>
					</li>
				
			</ul>
		</div>
	
</div>

  <div class="contribution_section_box" id="in_packs_box">
  
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[All the Packs that this item (or versions of this item [[if available]]) is referred to in] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Featured In Packs  <span class="count_text">(0)</span>
		<a name="featured_in_packs"></a>
	</p>
	
		<p class="none_text">None</p>
	
	
	
		<p><small><b><a href="/session/new">Log in</a></b> to add to one of your Packs</small></p>
	
</div>


  <div class="contribution_section_box">
	
	<p class="heading" style="margin-bottom: 0; padding-bottom: 0;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[Shows files and workflows that have attributed this Workflow.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Attributed By <span class="count_text">(1)</span>
	  <a name="attributed_by"></a>
	</p>
	<span style="font-size: 85%; color: #666666; display: block; padding: 0.3em 0.5em 0 0.5em; margin: 0; line-height: 1em;">(Workflows/Files)</span>
	
		
		<div style="font-size: 85%;">
			<p>
				<ul class="items">
					
						<li>
							
								
									
										<span class="icon"><img alt="Workflow" src="/images/redmond_studio/applications_16.png?1680607579" /> </span> 
									 
									<a href="/workflows/3959">BioVeL ESW DIFF Basic</a>
								
							
						</li>
					
				</ul>
			</p>
		</div>
	
	
</div>


  
<div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The users who have added this Workflow to their favourites] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Favourited By <font class="count_text">(0)</font>
		<a name="favourited_by"></a>
	</p>
	
	
		<p class="none_text">No one</p>
	
	
	
</div>

  

<div class="contribution_section_box">
	<p class="heading" style="margin-bottom: 0.3em;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[Viewing / download counts are grand totals for this Workflow.&lt;br/&gt;Click &#39;see breakdown&#39; to view details.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Statistics
	</p>
	
	<div class="stats_box"> 
		<p style="font-size: 85%;">
  11739 viewings
</p>

	<p style="font-size: 85%;">
	  2027 downloads
	</p>

<p style="margin-top: 0.2em;">
	<small>[ <a href="/workflows/3647/statistics">see breakdown</a> ]</small>
</p>
		
		<div class="fold" style="padding-top: 0.6em;">
			<div class="foldTitle">More</div>
			<div class="foldContent" style="display: none; text-align: left;">
				
					<p>
						<a href="#credits">1 credit</a> <!-- won't work for type=='group'; needs anchor called '#group_creditations' -->
					</p>
					
					<p>
						<a href="#attributions">0 attributions</a>
					</p>
				
				
				
					<p>
			      <a href="#tags">12 tags</a>
			    </p>
				
				
				
					<p>
			      <a href="#favourited_by">0 favourites</a>
			    </p>
				

				
					<p>
						<a href="#citations">0 citations</a>
			    </p>
				
				
				
					<p>
			      <a href="#reviews">0 reviews</a>
			    </p>
				
				
				
			    <p>
			    	<a href="#comments">0 comments</a>
			    </p>
				
			</div>
		</div>
		
		
		
		
	</div>
</div>

</div>

<div class="clearer">&nbsp;</div>

<!-- BEGIN tabs -->

<br/>

<div id="tabsContainer" class="tabsContainer"></div>

<div class="tabContainer">
  <div class="tabTitle">Citations (0)</div>
  <div class="tabContent">

    <a name="citations"></a>
    
      <p><i>None</i></p>
    
		
		<br/>

    

  </div>
</div>


<div class="tabContainer">
  <div class="tabTitle">Version History</div>
  <div class="tabContent">
    <a name="version_history"></a>
    <p>In chronological order:</p>

<ol class="version_history">
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/1">PSW - PostanalyticalStatisticWorkflow with difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Monday 08 July 2013 15:06:00 (UTC)
        </p>

        

        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/2">BioVeL PSW - Post statistical workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Thursday 11 July 2013 15:29:22 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>add TDWG Level3 Shapefile as PNG output background</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/3">BioVeL PSW - Post statistical workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Friday 12 July 2013 10:20:12 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>add country borders based on TDWG level4 layer</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/4">BioVeL PSW - Post statistical workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Friday 12 July 2013 14:56:05 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>update the overall_coverage function</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/5">BioVeL PSW - Post statistical workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Wednesday 14 August 2013 22:07:08 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>some spelling corrections</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/6">BioVeL PSW - Post statistical workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Sunday 18 August 2013 08:48:31 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>Change the desription and the title</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/7">BioVeL ESW - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Sunday 18 August 2013 09:02:59 (UTC)
        </p>

        

        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/8">BioVeL ESW - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Wednesday 04 September 2013 09:39:58 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>add distribution points to the PNG overview and the BioSTIF URL</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/9">BioVeL ESW - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Thursday 05 September 2013 13:03:07 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>change default CSV input port value to &quot;none&quot;</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/10">BioVeL ESW - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Wednesday 18 September 2013 16:41:24 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>add CSV file and CSV content as input for points</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/11">BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Friday 11 October 2013 12:00:42 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>change WF name, improve detection of R serve version to replace deprecated functions</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/12">BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Sunday 13 October 2013 12:21:24 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>modified description</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/13">BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Sunday 10 November 2013 22:49:55 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>correction in the summary file computation</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/14">BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Tuesday 21 January 2014 16:10:39 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>Error correction in the coverage of the prediction file</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/15">BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20320" title="header=[] body=[Robert Kulawik] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Robert Kulawik</a>
          
          on Friday 22 August 2014 09:24:13 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>* Add the possibility to calculate and display the centre of mass and the shift vector.<br /><br />* Avoid uploading files to BioSTIF as they are already displayed correctly in the PNGs</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3647/versions/16">BioVeL ESW DIFF - ENM Statistical Workflow with raster difference computation</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/62314" title="header=[] body=[Biodiversity eLaboratory] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Biodiversity eLaboratory</a>
          
          on Wednesday 22 June 2016 14:45:16 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>Change the location of resources using in this workflow&nbsp;from the biovel google code repository to the&nbsp;biovel github repository</p>
            </div>
          </p>
        
      </div>
    </li>
  
</ol>


  </div>
</div>



<!-- END tabs -->

<br/>
<br/>

<div id="ratingsBox">
  <h2>
	<span class="icon"><img alt="Reviews" src="/images/famfamfam_silk/report.png?1680607579" /> </span>	<span style="vertical-align: middle;"><a href="/workflows/3647/reviews">Reviews</a></span>
	<span class="count_text" style="vertical-align: middle;">(0)</span>
</h2>

<div class="reviewsBox">

	
		<p><i>No reviews yet</i></p>
		<a name="reviews"></a>
		<p style="margin-top: 0.6em;">
			<strong><a href="/workflows/3647/reviews/new">Be the first to review!</a></strong>
		</p>
	
	
</div>

</div>

<br/>
<br/>

<div id="commentsBox">
  <script src="/javascripts/ckeditor/ckeditor.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/widgets/tooltip.js?1680607579" type="text/javascript"></script>

<h2>
	<span class="icon"><img alt="Comments" src="/images/famfamfam_silk/comments.png?1680607579" /> </span>	<span style="vertical-align: middle;">Comments</span>
	<span class="count_text" style="vertical-align: middle;">(0)</span>
</h2>

<ul class="sectionIcons">
  <li><span class="icon"><a href="http://www.myexperiment.org/workflows/3647/comments/timeline"><img alt="Timeline" src="/images/famfamfam_silk/timeline_marker.png?1680607579" /> View Timeline</a></span></li>
</ul>

<div class="commentsBox">
	
	
		<p><i>No comments yet</i></p>
		<a name="comments"></a>
		
			<p style="margin-top: 0.6em;"><strong><a href="/session/new">Log in</a> to make a comment </strong></p>
		
	
	
	<br/>
	
	

</div>


</div>

<!-- Other workflows that use a service this workflow users -->

<br />
<br />

<h2>
  <span class="icon"><img alt="Workflow" src="/images/redmond_studio/applications_16.png?1680607579" /> </span>  <span style="vertical-align: middle;">Other workflows that use similar services</span>
  <span class="count_text" style="vertical-align: middle;">(0)</span>
</h2>




    <p>There are no workflows in myExperiment that use similar services to this Workflow.</p>



<!-- OpenURL context object -->

<span class="Z3988" title="url_ver=Z39.88-2004&amp;url_ctx_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Actx&amp;ctx_ver=Z39.88-2004&amp;ctx_tim=2023-08-16T16%3A23%3A32%2B00%3A00&amp;ctx_id=&amp;ctx_enc=info%3Aofi%2Fenc%3AUTF-8&amp;rft.title=BioVeL+ESW+DIFF+-+ENM+Statistical+Workflow+with+raster+difference+computation&amp;rft.date=2013-07-08&amp;rft.au=Francisco+Quevedo&amp;rft.genre=unknown&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc"></span>
      </div>
    </div>




            <div id="ft">
          <div class="container">
  <div class="row">
    <div class="col-md-4 text-left">
      Funded by:
      <a href="http://biovel.eu">BioVeL</a>,
      <a href="http://www.epsrc.ac.uk/">EPSRC</a>,
      <a href="http://jisc.ac.uk/">JISC</a>,
      <a href="http://www.microsoft.com">Microsoft</a>

      <br/><br/>

      Affiliates:
      <a href="http://www.mygrid.org.uk">myGrid</a>,
      <a href="http://www.taverna.org.uk/">Taverna</a>,
      <a href="http://www.biocatalogue.org">BioCatalogue</a>
    </div>

    <div class="col-md-4 text-center">
      <a href="/about">About</a> |
      <a href="/privacy">Privacy</a> |
      <a href="http://wiki.myexperiment.org/index.php/Papers">Publications</a> |
      <a href="/feedback">Contact / Feedback</a> |
      <a href="http://lists.nongnu.org/mailman/listinfo/myexperiment-discuss">Mailing List</a>
    </div>

    <div class="col-md-4 text-right">
      Icons: <a href="http://www.famfamfam.com/lab/icons/silk/">Silk icon set 1.3</a><br/><br/>
      
    </div>

  </div>
  <div class="row">
    <div class="col-md-12 text-center">
      Copyright &#169; 2007 &ndash; 2018
      <a href="http://www.manchester.ac.uk/">The University of Manchester</a>
      and
      <a href="http://www.soton.ac.uk/">University of Southampton</a>
    </div>
  </div>
</div>

        </div>
    



<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1498417-4', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>



  
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36850736-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  


</body>
</html>

