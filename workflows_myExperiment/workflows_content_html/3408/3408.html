








  


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="google-site-verification" content="3hq0Cfhw5_-EaaNMum0ETX847sTl7jeQ3ZNAla4a6UQ" />
  
  <title>myExperiment &#45; Workflows &#45; Bayesian Phylogenetic Inference: Select Model -  Submission (Saverio Vicario) [Taverna 2 Workflow]</title>
  <link rel="alternate" href="http://www.myexperiment.org/workflows/3408.rdf" type="application/rdf+xml" title="RDF+XML" />
  <link rel="alternate" href="http://www.myexperiment.org/workflows/3408.xml" type="application/xml" title="REST XML" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
  <link href="/stylesheets/acts_as_taggable_stylesheet.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/star_rating.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/gadgets.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/misc_skinning.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/pagination.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/bootstrap.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/navbar.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/styles.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/biovel.css?1680607579" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/jquery-1.11.1.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/jquery-noconflict.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/prototype-1.7.2-patched.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/effects.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/dragdrop.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/controls.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/boxover.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/bootstrap.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/tabs.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/folds.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/application.js?1680607579" type="text/javascript"></script>

  
  






  
  
    <script src='//www.google.com/recaptcha/api.js'></script>
  
</head>
<body>



<div class="navbar navbar-myexp" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
          
  <a href="http://biovel.eu/" style="float: left"><img alt="Biovel_logo_white_background" height="50" src="/images/biovel_logo_white_background.png?1680607579" width="38" /></a>
      
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        
          
  <ul class="nav navbar-nav">
    
      <li >
        <a href="/groups/1013">BioVeL</a>      </li>
    
      <li id="selected_tabnav">
        <a href="/groups/1013/workflows">Workflows</a>      </li>
    
      <li >
        <a href="/groups/1013/files">Files</a>      </li>
    
      <li >
        <a href="/groups/1013/packs">Packs</a>      </li>
    
  </ul>

        
        
            <form action="/search" class="navbar-form navbar-left" id="search" method="get">
    <div class="input-group">
      <input class="form-control" id="query" name="query" placeholder="Search" type="text" />
      <span class="input-group-btn">
        
        <input class="btn btn-default" name="commit" type="submit" value="Go" />
        </span>
    </div>
</form>

        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
            <li><a href="/session/new?return_to=%2Fworkflows%2F3408.html">Log in</a></li>
    <li><a href="/users/new">Register</a></li>


      </ul>
    </div><!--/.nav-collapse -->
  </div>
  
      <div id="site_info_links">
        <div class="container">
          
    <a href="/home">Back to <img alt="Logo_tiny" src="/images/logo_tiny.png?1680607579" style="vertical-align: bottom" /></a>    <span class="divider">|</span>
    <a href="http://www.biovel.eu/about-biovel" target="blank">About BioVeL</a>
    <span class="divider">|</span>
    <a href="http://portal.biovel.eu" target="blank">BioVeL Portal</a>
    <span class="divider">|</span>
    <a href="https://www.biodiversitycatalogue.org/" target="blank">Biodiversity Catalogue</a>

        </div>
      </div>
  
</div>




    <div class="container" id="main">
      <div id="myexp_breadcrumbs_bar">
        <ol class="breadcrumb">
  <li><a href="/home">Home</a></li>
  


  <li><a href="/workflows">Workflows</a></li>



  
    <li>Bayesian Phylogenetic Inference: Select Model -  Submission</li>
  


  <div style="float: right"></div>
</ol>

      </div>
      <div id="myexp_content">
        


        



<h1 class="contribution_title">
  Bayesian Phylogenetic Inference: Select Model -  Submission
</h1>

<div class="contribution_aftertitle">
	<b>Created:</b> 2013-02-20 13:47:05
	
		&nbsp;&nbsp;&nbsp;&nbsp;
		<b>Last updated: </b>2014-07-04 09:53:04
	
</div>
<ul class="sectionIcons">
  
      <li><span class="icon"><a href="http://www.myexperiment.org/workflows/3408/download/Bayesian_Phylogenetic_Inference__Select_Model_-__Submission-v4.t2flow?version=4"><img alt="Download Workflow (for version 4)" src="/images/redmond_studio/arrow-down_16.png?1680607579" /> Download Workflow</a></span></li>
      
  
      
</ul>


<div class="contribution_left_box">

  <div class="contribution_version_box">



    <div class="contribution_version_inner_box">

      
    <div class="contribution_description">
      <p>
BioVeL – Biodiversity Virtual e-Laboratory   
</p>

<p>
Workflow Documentation   
</p>

<p>
Name:Perform Short Bayesian Phylogenetic Inference  
</p>

<p>
Capacities Programme of Framework 7: EC e-Infrastructure Programme –   
e-Science Environments - INFRA-2011-1.2.1   
Grant Agreement No: 283359   
Project Co-ordinator: Mr Alex Hardisty   
Project Homepage: [<a href="http://www.biovel.eu][1" rel="nofollow">http://www.biovel.eu][1</a>]
</p>

<p>
   [1]: <a href="http://www.biovel.eu" rel="nofollow">http://www.biovel.eu</a>
</p>

<p>
##   
1 Description
</p>

<p>
The Pack contain 3 workflows that perform and validate bayesian phylogenetic inference that differ from the kind of input. The pack is called short because the worlflow require that the user need to keep taverna engine always on for the the time of the analysis. This could be quite problematic for large analysis. In this case search help in the "Perform Long Bayesian Phylogenetic Inference" pack
</p>

<p>
In this pack there are 3 workflows:
</p>

<p>
1) User locally formatted input file (for details in nexus format for mrbayes [<a href="http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][2" rel="nofollow">http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][2</a>])  
</p>

<p>
2) User is helped by a GUI (graphical user interface) to define an partitioned evolutionary model on user defined MSA (multiple sequence alignment)  
</p>

<p>
3) PartitionFinder define best candidate partitioned evolutionary model based on proposed maximum set of possible partition  
</p>

<p>
Note: a partitioned model is a model that allow different groups of sites (i.e. columns of the MSA) to follow the rule or parameters set of different evolutionary models. MrBayes allows that some of the parameters to be shared across partitions while other being different. The submit workflow 2 based on the GUI allow to fully take advantage of this features while the submit workflow 3 based on PartitionFinder allow to share across partition optionally branch length and always the topology  
</p>

<p>
All 3 workflows perform 2 validations on the inference, one on the numerical integration (GeoKS) and one on the fit of the model (Posterior Predictive Test)  
</p>

<p>
   [2]: <a href="http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2" rel="nofollow">http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2</a>
</p>

<p>
## 2 General
</p>

<p>
**2.1 Name of the workflow and myExperiment +BiodiversityCatalogue identifiers**  
Name: Perform Short Bayesian Phylogenetic Inference  
Download info: [<a href="http://www.myexperiment.org/packs/371.html][3" rel="nofollow">http://www.myexperiment.org/packs/371.html][3</a>]  
BiodiversityCatalogue entry:   
</p>

<p>
**2.2 Date, version and licensing**  
Last [updated:21/02/13][4] @ 09:08:18  
Version: 2  
Licensing: Creative Commons Attribution ShareAlike CC-BY- SA  
</p>

<p>
**2.3 How to cite this workflow**  
</p>

<p>
These results come from the processing of data (personal source or others--cite which one, i.e. ENA) through BioVeL's services ([<a href="http://www.biovel.eu][5" rel="nofollow">www.biovel.eu][5</a>]). BioVeL is funded by the EU’s Seventh Framework Program, grant no. 283359. Use the article [<a href="http://journal.embnet.org/index.php/embnetjournal/article/view/557][6" rel="nofollow">http://journal.embnet.org/index.php/embnetjournal/article/view/557][6</a>]
</p>

<p>
   [3]: <a href="http://www.myexperiment.org/packs/371.html" rel="nofollow">http://www.myexperiment.org/packs/371.html</a>
   [4]: <a href="http://updated:21/02/13" rel="nofollow">http://updated:21/02/13</a>
   [5]: <a href="http://www.biovel.eu" rel="nofollow">http://www.biovel.eu</a>
   [6]: <a href="http://journal.embnet.org/index.php/embnetjournal/article/view/557" rel="nofollow">http://journal.embnet.org/index.php/embnetjournal/article/view/557</a>
</p>

<p>
##   
</p>

<p>
<ol>
<li value="3">Scientific Specifications</li>
</ol>
</p>

<p>
**3.1. Keywords:** Phylogenetic inference, Bayesian, MrBayes, Posterior Predictive test, Convergence test  
**3.2. Scientific workflow description:**  
</p>

<p>
The different step for a complete phylogenetic inference are in this pack divided as following:  
</p>

<p>
  1. Define model framework
  2. Estimate parameters of the model framework with a Markovian Integration within a Bayesian framework
  3. Validate the convergence of the Markovian Integration with a test on the overlap of the tree posterior distribution of two or more independent runs (GeoKS)
  4. Test the adequacy or goodness of fit of the model with a posterior predictive test
</p>

<p>
**3.2.1 Define model framework:**  
</p>

<p>
MrBayes allows to define partitioned model of evolution of the character of the MSA, to perform a given phylogenetic inference. A  
</p>

<p>
Partitioned model is a model that allow different groups of sites (i.e. columns of the MSA) to follow the rule or parameters set of different evolutionary models.  
</p>

<p>
Within MrBayes is possible to define 5 group of parameters that can be shared or not across user defined group of sites  
</p>

<p>
  1. Substitution Matrix
  2. State frequencies
  3. Site Specific rates
  4. Branch lengths
  5. Topology
</p>

<p>
Workflow 1 "All is ready to run". leave the user the duty to define and format a model using the criteria and tool preferred.  
</p>

<p>
Workflow 2 "Select Model" based on a GUI help the user to define a model that share or not across user defined partition independently all 5 groups of parameters, taking care of the formatting.  
</p>

<p>
Workflow 3 "Select Model for Me" based on PartitionFinder ([<a href="http://www.robertlanfear.com/partitionfinder/][7" rel="nofollow">http://www.robertlanfear.com/partitionfinder/][7</a>]) allows to define the best partitioning of the sites based on a starting maximal partitioning proposed by the user, but decision of the sharing or not across partition is done together for groups 1, 2, and 3 while branch lengths could be shared across all partition or none (no sharing across some partitions) and topology need to be shared across all sites.
</p>

<p>
   [7]: <a href="http://www.robertlanfear.com/partitionfinder/" rel="nofollow">http://www.robertlanfear.com/partitionfinder/</a>
</p>

<p>
![][8] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > PhyloInfWFColorAll-renzo.png" data-location="BioVeL User Documentation > Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > PhyloInfWFColorAll-renzo.png">  
</p>

<p>
**3.2.2 Estimate parameters of the model framework with a Markovian Integration within a Bayesian framework:**  
</p>

<p>
All 3 submit workflows send the input defined and formatted differently to the same service that start a MrBayes run. (ref 1,2,3)  
</p>

<p>
**3.2.3 Validate the convergence of the Markovian Integration with a test on the overlap of the tree posterior distribution of two or more independent runs (GeoKS):**  
</p>

<p>
The result of the MrBayes service are loaded by the retrieval workflow that perform a test of convergence based on the on the overlap of the tree posterior distribution of two or more independent runs. Details on this link  
</p>

<p>
**3.2.4 Test the adequacy or goodness of fit of the model with a posterior predictive test**:  
</p>

<p>
The service written in python read each estimation of set of parameters from a sub-sample of the overall posterior distribution and simulated (using evolver utility from PAML 1.4 package) new MSA. The simulated distribution is compared to the original MSA based on the sum of the sites entropy as proposed by Bollback (2002)[ref 4]  
</p>

<p>
An Histogram is draw for the distribution of the complexities (log of sum of sites entropy or maximal possible loglikelihood score) of the simulated data using the posterior distribution parameters compared with observed data complexity. The 1-alpha high posterior density of the distribution show the region where simulate data complexity match the observed one. Larger observed complexity indicates model too simplistic, while the contrary indicates overparametrization of the model.
</p>

<p>
   [8]: /download/attachments/8619115/PhyloInfWFColorAll-renzo.png?version=1&modificationDate=1393242192541&api=v2 (BioVeL User Documentation > Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > PhyloInfWFColorAll-renzo.png)
</p>

<p>
**3.2.5 Visualization of the consensus inference**
</p>

<p>
The newick representation of the consensus of the inference is sent to the ITOL web service ([see details at <a href="http://itol.embl.de/][9" rel="nofollow">http://itol.embl.de/][9</a>]). The service allows to visualize an interactive graphical representation of the tree. After manipulation and editing the tree can be exported in several graphical format or downloaded as newick or phyloxml format. Relaoding the tree with this format togheter with user defined annotation table allows very powerfull graphical representation of the tree (see details on [<a href="http://itol.embl.de/help/help.shtml][10" rel="nofollow">http://itol.embl.de/help/help.shtml][10</a>])
</p>

<p>
   [9]: <a href="http://itol.embl.de/" rel="nofollow">http://itol.embl.de/</a>
   [10]: <a href="http://itol.embl.de/help/help.shtml" rel="nofollow">http://itol.embl.de/help/help.shtml</a>
</p>

<p>
## 4. Technical Specifications
</p>

<p>
**4.1. Execution environment and installation requirements**  
</p>

<p>
The 3 workflows are all tested on taverna workbench. They should be able to be loaded on Taverna Lite  
**4.2. Taverna installation, including updates and plug-ins**
</p>

<p>
[Taverna workbench installation][11]  
[Interaction plug-in][12]  
**4.2.1 Taverna Dependencies**  
</p>

<p>
The all 3 workflow require a local R serve to allow to draw the graph output of the Posterior Predictive Test.  
</p>

<p>
The Workflow 3 based on Partition Finder, requires a python interpret installed on the path and accessible to Taverna engine. No python module is required by the script and although tested only with python 2.7 should work also with older python.   
</p>

<p>
   [11]: <a href="https://wiki.biovel.eu/display/doc/Taverna+Workbench" rel="nofollow">https://wiki.biovel.eu/display/doc/Taverna+Workbench</a>
   [12]: <a href="https://wiki.biovel.eu/display/doc/Customising+for+BioVeL#CustomisingforBioVeL-InstallingtheInteractionplug-in" rel="nofollow">https://wiki.biovel.eu/display/doc/Customising+for+BioVeL#CustomisingforBioVeL-InstallingtheInteractionplug-in</a>
</p>

<p>
## 5. Tutorial - how to do it
</p>

<p>
**5.1. Introduction**  
</p>

<p>
The user depending of the 3 different scenarios presented in 3.2.1 will choose one of the 3 submit workflows.  
**5.2. Input data**  
**5.2.1. Data preparation/format**  
</p>

<p>
Workflow 1 the format for the input (called"NexusFile") is nexus with data block and mrbayes block. Within the data block the MSA is specified together with the type of possible states, while in the mrbayes block the user need to define the evolutionary model and the parameters for the markovian integration ( number of generation, temperature, number of chain for the metropolis coupled part of the algorithm, and number of replicates runs to control convergence). See details in [<a href="http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][13" rel="nofollow">http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][13</a>]  
</p>

<p>
Workflow 2 and 3 require a MSA in aligned multifasta format (see [<a href="http://en.wikipedia.org/wiki/FASTA_format][14" rel="nofollow">http://en.wikipedia.org/wiki/FASTA_format][14</a>]). Recognized gap character is "-"  
</p>

<p>
Workflow 3 require also a text in which user define maximum set of parts fo the alignment, meaning the maximal subdivision in group that sites could have. Mind the Partitionfinder try all combinatorial change possible and is not adivsed to propose more than 14 parts.
</p>

<p>
   [13]: <a href="http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2" rel="nofollow">http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2</a>
   [14]: <a href="http://en.wikipedia.org/wiki/FASTA_format" rel="nofollow">http://en.wikipedia.org/wiki/FASTA_format</a>
</p>

<p>
Syntax to define partition is the following:
</p>

<p>
Each part is defined by a alpha numeric string with no space (the name) connected by an equal sign to the list of sites to be included. Description end with the semicolon sign.
</p>

<p>
A range of sites are described as start and ending sites divided by minus sign (i.e. gene1= 10-30;) with both start and end included
</p>

<p>
Discontinue sections are divided by a space (i.e. gene1= 10-30 34 40;)
</p>

<p>
Range with a step (i.e.“every third base”) are expressed with a slash (i.e. gene1= 10-30\3;)
</p>

<p>
So a complex but realistic example could be:
</p>

<p>
utr5= 1-30;
</p>

<p>
cds_pos1 = 30-200/3 400-500/3;
</p>

<p>
cds_pos2 = 31-200/3 399-500/3;
</p>

<p>
cds_pos3 = 32-200/3 398-500/3;
</p>

<p>
intron= 200-397;
</p>

<p>
utr3= 501-600;
</p>

<p>
**5.2.2. Other input   
**
</p>

<p>
file name: name for the nexus file produced on the basis of partitionFinder results
</p>

<p>
number of MCMCMC generations: integer indicating number of generation to be used in the markovian integration
</p>

<p>
number of runs: integer indicating how many indipendent runs of mrbayes need to be performed ( the more the better convergence is detected
</p>

<p>
branch length are linked or unlinked across partition: see 3.2.1 for details
</p>

<p>
what criterium to be used by PartitionFinder: the criteria a AIC, AICc and BIC. All of them are information criteria. In general statistical framework AIC should be always prefferrd to AIC but in phylogenetics there are dispute on how to count constant sites. If your MSA have very few constant sites or you selected your locus randomly use AICc without doubt. For large MSA AIC and AICc give similar results.
</p>

<p>
**5.3. Select Dialogue boxes**
</p>

<p>
For each web services called a message tell the user the name and the number of the job id to the user. The message disappear after the user would push any of the buttons or if another web services is called before any action is taken. The message allows the user to know at what point of the workflow is and gives the job id number that would allow the service centre to identify the job, in case of failure.
</p>

<p>
![][15] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > Schermata 2013-08-09 alle 15.53.43.png" data-location="BioVeL User Documentation > Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > Schermata 2013-08-09 alle 15.53.43.png">  
Workflow 1 does not have specific dialog box  
</p>

<p>
Worklfow 2 have a large and complex self explanatory web page. To start to use paste a aligned multifasta file in the only visible text window and click confirm. Following choice are explained by yellow bottom on the side of each question or pull down menu  
</p>

<p>
Workflow 3 have following dialog box:
</p>

<p>
   [15]: /download/attachments/8619115/Schermata%202013-08-09%20alle%2015.53.43.png?version=1&modificationDate=1376213644377&api=v2 (BioVeL User Documentation > Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > Schermata 2013-08-09 alle 15.53.43.png)
</p>

<p>
partition to be selected: this windows allows to choose a subset of partition to be used. At the moment is not relevant but coupling this workflow with alignment this windows could be not redundant
</p>

<p>
![][16] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > Schermata 2013-08-09 alle 15.39.49.png" data-location="BioVeL User Documentation > Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > Schermata 2013-08-09 alle 15.39.49.png">  
</p>

<p>
**5.4. Save data/results**   
</p>

<p>
The 3 workflows have the following outputs:
</p>

<p>
   [16]: /download/attachments/8619115/Schermata%202013-08-09%20alle%2015.39.49.png?version=1&modificationDate=1376213738892&api=v2 (BioVeL User Documentation > Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal > Schermata 2013-08-09 alle 15.39.49.png)
</p>

<p>
**Plot**
</p>

<p>
Description:
</p>

<p>
Result of the Posterior Predictive test. Histogram of the distribution of the complexities (log of sum of sites entropy or maximal possible loglikelihood score) of the simulated data using the posterior distribution parameters compared with observed data complexity. The 1-alpha high posterior density of the distribution show the region where simulate data complexity match the observed one. Larger observed complexity indicates model too simplistic, while the contrary indicates overparametrization of the model
</p>

<p>
**Newicktree**
</p>

<p>
Description:
</p>

<p>
small xml with tag res with one or more tag tree each one with a body that contain a tree in netwick format.
</p>

<p>
each tree represent the consensus for a given partition of group of partition in the same order that are cited in the nexus input file of mrbayes
</p>

<p>
**Geoks**
</p>

<p>
Description:
</p>

<p>
Result of the GeoKS test of convergence. XML format
</p>

<p>
**Phyloinferenceoutput** *
</p>

<p>
Description:
</p>

<p>
The output of the consensus service is a path were to obtain a zipped folder that includes all output from phylogenetic inference and the one of the consensus
</p>

<p>
**Viewtree***
</p>

<p>
Description:
</p>

<p>
Link to visualize consensus Tree of phylogenetic inference. It could be more than one link if the model assume more than one tree (combination topology + branch length set).
</p>

<p>
Use of the figure in the link below should be always accompagned by appropriate citation:
</p>

<p>
Letunic I and Bork P (2011) Nucleic Acids Res doi: 10.1093/nar/gkr201 Interactive Tree Of Life v2: online annotation and display of phylogenetic trees made eas
</p>

<p>
**Mrbayesoutput***
</p>

<p>
Description:
</p>

<p>
original output of mrbayes
</p>

<p>
**Detailspptest**
</p>

<p>
Description:
</p>

<p>
Numeric Result of the Posterior Predictive test.
</p>

<p>
**Partitionfinderoutput**
</p>

<p>
Description:
</p>

<p>
Main output of PartitionFinder, where the preffered partitioned model is described
</p>

<p>
**Log**
</p>

<p>
Description:
</p>

<p>
Log file of all application used in the workflow. For each external website is reported the name of the application , the jobid required to track error on the service provvider and the last 200line of the standardouput+standardError of the application as view by the local system where the job was run.
</p>

<p>
**Partitionfinderdetails***
</p>

<p>
Description:
</p>

<p>
Path were to retrieve all the detials of the partitionfinder software
</p>

<p>
**Geoksdetails***
</p>

<p>
Description:
</p>

<p>
Path were to get all details of convergence test calculation.
</p>

<p>
Ouput with * are also exposed on a downloadable link in the web browser as soon as they are produced  
**5.5. Results analysis**   
</p>

<p>
If the GeoKS test fail, the p-value is lower of the risk accepted by the user, the workflow stop and do not perform the posterior predictive test and the tree consensus calculation. User is invited to look at GeoKS result and increase the generation number of at least 1.5 times.  
</p>

<p>
If the GeoKS test do not fail, the p-value is higher of the risk accepted by the user, the user is invited to check that no more generation are advised by GeoKS. In fact the program advise the user for more generation if less that 300 Effective Sample Size (ESS) Tree are present in the posterior distribution. With less than 300 ESS trees the test do not guarantee to have sufficient power to detect correctly convergence. Then the user should look at the plot output and check if the red line (observed MSA complexity) is within the HSD of the distribution. If the red line is on the right of the distribution a more complex model need to be taken in consideration. if the red line is on the left of the distribution it could be than a more simple model could be entertained, and branch support are excessively conservative.  
</p>

<p>
Once the two tests are positive the user could inspect the consensus tree on ITOL, decorate at will and print on file the tree for a publication. The naked netwick tree could be also extracted using the option save tree from ITOL or directly from the output port newick  
</p>

<p>
## 6. Support
</p>

<p>
For questions with using the workflow, please write [<a href="mailto:support@biovel.eu" rel="nofollow">support@biovel.eu</a>][17].  
For definitions of technical and biological terms, please visit the BioVeL glossary page: [<a href="https://wiki.biovel.eu/display/BioVeL/Glossary][18" rel="nofollow">https://wiki.biovel.eu/display/BioVeL/Glossary][18</a>]   
</p>

<p>
   [17]: mailto:<a href="mailto:support@biovel.eu" rel="nofollow">support@biovel.eu</a>
   [18]: <a href="https://wiki.biovel.eu/display/BioVeL/Glossary" rel="nofollow">https://wiki.biovel.eu/display/BioVeL/Glossary</a>
</p>

<p>
## 7. Bibliography
</p>

<p>
<ol>
<li value="1">Huelsenbeck JP, Larget B, Miller RE, Ronquist F. Potential applications and pitfalls of Bayesian inference of phylogeny. Systematic biology. 2002;51(5):673–88. Available at: [<a href="http://sysbio.oxfordjournals.org/content/51/5/673.abstract][19" rel="nofollow">http://sysbio.oxfordjournals.org/content/51/5/673.abstract][19</a>] [Accessed January 29, 2013].  </li>
<li value="2">Huelsenbeck JP, Ronquist F. MRBAYES: Bayesian inference of phylogenetic trees. Bioinformatics (Oxford, England). 2001;17(8):754–5. Available at: [<a href="http://www.ncbi.nlm.nih.gov/pubmed/11524383][20" rel="nofollow">http://www.ncbi.nlm.nih.gov/pubmed/11524383][20</a>] [Accessed January 29, 2013].  </li>
<li value="3">Altekar G, Dwarkadas S, Huelsenbeck JP, Ronquist F. Parallel Metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference. Bioinformatics (Oxford, England). 2004;20(3):407–15. Available at: [<a href="http://www.ncbi.nlm.nih.gov/pubmed/14960467][21" rel="nofollow">http://www.ncbi.nlm.nih.gov/pubmed/14960467][21</a>].  </li>
<li value="4">Bollback JP. Bayesian Model Adequacy and Choice in Phylogenetics. Molecular biology and evolution. 2002;19(7):1171–1180.</li>
</ol>
</p>

<p>
   [19]: <a href="http://sysbio.oxfordjournals.org/content/51/5/673.abstract" rel="nofollow">http://sysbio.oxfordjournals.org/content/51/5/673.abstract</a>
   [20]: <a href="http://www.ncbi.nlm.nih.gov/pubmed/11524383" rel="nofollow">http://www.ncbi.nlm.nih.gov/pubmed/11524383</a>
   [21]: <a href="http://www.ncbi.nlm.nih.gov/pubmed/14960467" rel="nofollow">http://www.ncbi.nlm.nih.gov/pubmed/14960467</a>
</p>


    </div>


      <h3>
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This section shows the preview of this version of the Workflow (click on the image to expand)] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Preview
      </h3>

      

          <div class="contribution_preview" style="width: 100%;">
            <p style="text-align: center">
              <a href="/workflows/3408/versions/4/previews/full" onclick="window.open(this.href);return false;"><img alt="Medium" src="/workflows/3408/versions/4/previews/medium" /></a>
            </p>
            
                <p style="text-align: right; color: #666666;">
                  <a href="/workflows/3408/versions/4/previews/svg">Download as scalable diagram (SVG)</a>
                </p>
            

            
          </div>
      



      <h3>
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This section provides options for running this version of the Workflow] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Run
      </h3>

      
          
              <div style="margin: 0 0.5em;">
	<h4>
		Run this Workflow in the Taverna Workbench...
	</h4>
	
	<div class="option_box">
		
		<p style="text-align: center;">
			<b>Option 1:</b>
		</p>
		
		<p style="font-size: 93%; text-align: center;">
			Copy and paste this link into File > 'Open workflow location...'<br/>
			<a href="http://www.myexperiment.org/workflows/3408/download?version=4">http://www.myexperiment.org/workflows/3408/download?version=4</a><br/>
			<small>[ <a href="#" onclick="Effect.toggle(&quot;run_taverna_more_box&quot;,'blind',{duration:0.3});; return false;">More Info<img alt="Expand" src="/images/folds/unfold.png?1680607579" style="margin-left: 0.3em; vertical-align: middle;" /></a> ]</small>
		</p>
		
		<div id="run_taverna_more_box" style="display: none;">
			<p style="font-size: 85%; margin-top: 0.5em; text-align: center;">
				Taverna is available from <a href="http://taverna.sourceforge.net/" onclick="window.open(this.href);return false;">http://taverna.sourceforge.net/</a>
			</p>
			
			<p style="text-align: center; margin-top: 0.5em; font-size: 85%;">
				If you are having problems downloading it in Taverna, you may need to provide your username and password in the URL so that Taverna can access the Workflow: <br/>
				
					<b>Replace <font color="#990000">http://</font> in the link above with <font color="#990000">http://yourusername:yourpassword@</font></b>
				
			</p>
		</div>
	
	</div>
</div>


          
      

      <br/>

      <h3>
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This section shows the internal components of this workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Workflow Components
      </h3>

      
          
              
	    <!-- Authors -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This is the author information extracted from the workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Authors (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
                          <tr>
                <td>saverio vicario
giacinto donvito
bachir balech
</td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Titles -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[These are the descriptive titles embedded within the workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Titles (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
                          <tr>
                <td>Bayesian Phylogenetic Inference: Select Model -  Submission</td>
              </tr>
            
          </table>
        
      </div>
    </div>

    <!-- Descriptions -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[These are the descriptions embedded within the workflow version] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Descriptions (1)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
                          <tr>
                <td>BioVeL – Biodiversity Virtual e-Laboratory   
  
Workflow Documentation   
  
Name:Perform Short Bayesian Phylogenetic Inference  
  
Capacities Programme of Framework 7: EC e-Infrastructure Programme –   
e-Science Environments - INFRA-2011-1.2.1   
Grant Agreement No: 283359   
Project Co-ordinator: Mr Alex Hardisty   
Project Homepage: [http://www.biovel.eu][1]

   [1]: http://www.biovel.eu

##   
1 Description

The Pack contain 3 workflows that perform and validate bayesian phylogenetic inference that differ from the kind of input. The pack is called short because the worlflow require that the user need to keep taverna engine always on for the the time of the analysis. This could be quite problematic for large analysis. In this case search help in the &quot;Perform Long Bayesian Phylogenetic Inference&quot; pack

In this pack there are 3 workflows:

1) User locally formatted input file (for details in nexus format for mrbayes [http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][2])  
  
2) User is helped by a GUI (graphical user interface) to define an partitioned evolutionary model on user defined MSA (multiple sequence alignment)  
  
3) PartitionFinder define best candidate partitioned evolutionary model based on proposed maximum set of possible partition  
  
Note: a partitioned model is a model that allow different groups of sites (i.e. columns of the MSA) to follow the rule or parameters set of different evolutionary models. MrBayes allows that some of the parameters to be shared across partitions while other being different. The submit workflow 2 based on the GUI allow to fully take advantage of this features while the submit workflow 3 based on PartitionFinder allow to share across partition optionally branch length and always the topology  
  
All 3 workflows perform 2 validations on the inference, one on the numerical integration (GeoKS) and one on the fit of the model (Posterior Predictive Test)  
  
  


   [2]: http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2

## 2 General

  
**2.1 Name of the workflow and myExperiment +BiodiversityCatalogue identifiers**  
Name: Perform Short Bayesian Phylogenetic Inference  
Download info: [http://www.myexperiment.org/packs/371.html][3]  
BiodiversityCatalogue entry:   
  
**2.2 Date, version and licensing**  
Last [updated:21/02/13][4] @ 09:08:18  
Version: 2  
Licensing: Creative Commons Attribution ShareAlike CC-BY- SA  
  
**2.3 How to cite this workflow**  
  
These results come from the processing of data (personal source or others--cite which one, i.e. ENA) through BioVeL&#39;s services ([www.biovel.eu][5]). BioVeL is funded by the EU’s Seventh Framework Program, grant no. 283359. Use the article [http://journal.embnet.org/index.php/embnetjournal/article/view/557][6]

   [3]: http://www.myexperiment.org/packs/371.html
   [4]: http://updated:21/02/13
   [5]: http://www.biovel.eu
   [6]: http://journal.embnet.org/index.php/embnetjournal/article/view/557

##   
3. Scientific Specifications

**3.1. Keywords:** Phylogenetic inference, Bayesian, MrBayes, Posterior Predictive test, Convergence test  
**3.2. Scientific workflow description:**  
  
The different step for a complete phylogenetic inference are in this pack divided as following:  
  


  1. Define model framework
  2. Estimate parameters of the model framework with a Markovian Integration within a Bayesian framework
  3. Validate the convergence of the Markovian Integration with a test on the overlap of the tree posterior distribution of two or more independent runs (GeoKS)
  4. Test the adequacy or goodness of fit of the model with a posterior predictive test

  
**3.2.1 Define model framework:**  
  
MrBayes allows to define partitioned model of evolution of the character of the MSA, to perform a given phylogenetic inference. A  
  
Partitioned model is a model that allow different groups of sites (i.e. columns of the MSA) to follow the rule or parameters set of different evolutionary models.  
  
Within MrBayes is possible to define 5 group of parameters that can be shared or not across user defined group of sites  
  


  1. Substitution Matrix
  2. State frequencies
  3. Site Specific rates
  4. Branch lengths
  5. Topology

  
Workflow 1 &quot;All is ready to run&quot;. leave the user the duty to define and format a model using the criteria and tool preferred.  
  
Workflow 2 &quot;Select Model&quot; based on a GUI help the user to define a model that share or not across user defined partition independently all 5 groups of parameters, taking care of the formatting.  
  
Workflow 3 &quot;Select Model for Me&quot; based on PartitionFinder ([http://www.robertlanfear.com/partitionfinder/][7]) allows to define the best partitioning of the sites based on a starting maximal partitioning proposed by the user, but decision of the sharing or not across partition is done together for groups 1, 2, and 3 while branch lengths could be shared across all partition or none (no sharing across some partitions) and topology need to be shared across all sites.

   [7]: http://www.robertlanfear.com/partitionfinder/

![][8] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; PhyloInfWFColorAll-renzo.png&quot; data-location=&quot;BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; PhyloInfWFColorAll-renzo.png&quot;&gt;  
  
**3.2.2 Estimate parameters of the model framework with a Markovian Integration within a Bayesian framework:**  
  
All 3 submit workflows send the input defined and formatted differently to the same service that start a MrBayes run. (ref 1,2,3)  
  
**3.2.3 Validate the convergence of the Markovian Integration with a test on the overlap of the tree posterior distribution of two or more independent runs (GeoKS):**  
  
The result of the MrBayes service are loaded by the retrieval workflow that perform a test of convergence based on the on the overlap of the tree posterior distribution of two or more independent runs. Details on this link  
  
**3.2.4 Test the adequacy or goodness of fit of the model with a posterior predictive test**:  
  
The service written in python read each estimation of set of parameters from a sub-sample of the overall posterior distribution and simulated (using evolver utility from PAML 1.4 package) new MSA. The simulated distribution is compared to the original MSA based on the sum of the sites entropy as proposed by Bollback (2002)[ref 4]  
  
An Histogram is draw for the distribution of the complexities (log of sum of sites entropy or maximal possible loglikelihood score) of the simulated data using the posterior distribution parameters compared with observed data complexity. The 1-alpha high posterior density of the distribution show the region where simulate data complexity match the observed one. Larger observed complexity indicates model too simplistic, while the contrary indicates overparametrization of the model.

   [8]: /download/attachments/8619115/PhyloInfWFColorAll-renzo.png?version=1&amp;modificationDate=1393242192541&amp;api=v2 (BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; PhyloInfWFColorAll-renzo.png)

**3.2.5 Visualization of the consensus inference**

The newick representation of the consensus of the inference is sent to the ITOL web service ([see details at http://itol.embl.de/][9]). The service allows to visualize an interactive graphical representation of the tree. After manipulation and editing the tree can be exported in several graphical format or downloaded as newick or phyloxml format. Relaoding the tree with this format togheter with user defined annotation table allows very powerfull graphical representation of the tree (see details on [http://itol.embl.de/help/help.shtml][10])

   [9]: http://itol.embl.de/
   [10]: http://itol.embl.de/help/help.shtml

  
  


## 4. Technical Specifications

**4.1. Execution environment and installation requirements**  
  
The 3 workflows are all tested on taverna workbench. They should be able to be loaded on Taverna Lite  
**4.2. Taverna installation, including updates and plug-ins**

[Taverna workbench installation][11]  
[Interaction plug-in][12]  
**4.2.1 Taverna Dependencies**  
  
The all 3 workflow require a local R serve to allow to draw the graph output of the Posterior Predictive Test.  
  
The Workflow 3 based on Partition Finder, requires a python interpret installed on the path and accessible to Taverna engine. No python module is required by the script and although tested only with python 2.7 should work also with older python.   
  


   [11]: https://wiki.biovel.eu/display/doc/Taverna+Workbench
   [12]: https://wiki.biovel.eu/display/doc/Customising+for+BioVeL#CustomisingforBioVeL-InstallingtheInteractionplug-in

## 5. Tutorial - how to do it

**5.1. Introduction**  
  
The user depending of the 3 different scenarios presented in 3.2.1 will choose one of the 3 submit workflows.  
**5.2. Input data**  
**5.2.1. Data preparation/format**  
  
Workflow 1 the format for the input (called&quot;NexusFile&quot;) is nexus with data block and mrbayes block. Within the data block the MSA is specified together with the type of possible states, while in the mrbayes block the user need to define the evolutionary model and the parameters for the markovian integration ( number of generation, temperature, number of chain for the metropolis coupled part of the algorithm, and number of replicates runs to control convergence). See details in [http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][13]  
  
Workflow 2 and 3 require a MSA in aligned multifasta format (see [http://en.wikipedia.org/wiki/FASTA_format][14]). Recognized gap character is &quot;-&quot;  
  
Workflow 3 require also a text in which user define maximum set of parts fo the alignment, meaning the maximal subdivision in group that sites could have. Mind the Partitionfinder try all combinatorial change possible and is not adivsed to propose more than 14 parts.

   [13]: http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2
   [14]: http://en.wikipedia.org/wiki/FASTA_format

Syntax to define partition is the following:

Each part is defined by a alpha numeric string with no space (the name) connected by an equal sign to the list of sites to be included. Description end with the semicolon sign.

A range of sites are described as start and ending sites divided by minus sign (i.e. gene1= 10-30;) with both start and end included

Discontinue sections are divided by a space (i.e. gene1= 10-30 34 40;)

Range with a step (i.e.“every third base”) are expressed with a slash (i.e. gene1= 10-30\3;)

So a complex but realistic example could be:

utr5= 1-30;

cds_pos1 = 30-200/3 400-500/3;

cds_pos2 = 31-200/3 399-500/3;

cds_pos3 = 32-200/3 398-500/3;

intron= 200-397;

utr3= 501-600;

**5.2.2. Other input   
**

file name: name for the nexus file produced on the basis of partitionFinder results

number of MCMCMC generations: integer indicating number of generation to be used in the markovian integration

number of runs: integer indicating how many indipendent runs of mrbayes need to be performed ( the more the better convergence is detected

branch length are linked or unlinked across partition: see 3.2.1 for details

what criterium to be used by PartitionFinder: the criteria a AIC, AICc and BIC. All of them are information criteria. In general statistical framework AIC should be always prefferrd to AIC but in phylogenetics there are dispute on how to count constant sites. If your MSA have very few constant sites or you selected your locus randomly use AICc without doubt. For large MSA AIC and AICc give similar results.

  
  
**5.3. Select Dialogue boxes**

For each web services called a message tell the user the name and the number of the job id to the user. The message disappear after the user would push any of the buttons or if another web services is called before any action is taken. The message allows the user to know at what point of the workflow is and gives the job id number that would allow the service centre to identify the job, in case of failure.

![][15] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.53.43.png&quot; data-location=&quot;BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.53.43.png&quot;&gt;  
Workflow 1 does not have specific dialog box  
  
Worklfow 2 have a large and complex self explanatory web page. To start to use paste a aligned multifasta file in the only visible text window and click confirm. Following choice are explained by yellow bottom on the side of each question or pull down menu  
  
Workflow 3 have following dialog box:

   [15]: /download/attachments/8619115/Schermata%202013-08-09%20alle%2015.53.43.png?version=1&amp;modificationDate=1376213644377&amp;api=v2 (BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.53.43.png)

partition to be selected: this windows allows to choose a subset of partition to be used. At the moment is not relevant but coupling this workflow with alignment this windows could be not redundant

![][16] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.39.49.png&quot; data-location=&quot;BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.39.49.png&quot;&gt;  
  
  
  
  
**5.4. Save data/results**   
  
  
The 3 workflows have the following outputs:

   [16]: /download/attachments/8619115/Schermata%202013-08-09%20alle%2015.39.49.png?version=1&amp;modificationDate=1376213738892&amp;api=v2 (BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.39.49.png)

**Plot**

Description:

Result of the Posterior Predictive test. Histogram of the distribution of the complexities (log of sum of sites entropy or maximal possible loglikelihood score) of the simulated data using the posterior distribution parameters compared with observed data complexity. The 1-alpha high posterior density of the distribution show the region where simulate data complexity match the observed one. Larger observed complexity indicates model too simplistic, while the contrary indicates overparametrization of the model

**Newicktree**

Description:

small xml with tag res with one or more tag tree each one with a body that contain a tree in netwick format.

each tree represent the consensus for a given partition of group of partition in the same order that are cited in the nexus input file of mrbayes

**Geoks**

Description:

Result of the GeoKS test of convergence. XML format

**Phyloinferenceoutput** *

Description:

The output of the consensus service is a path were to obtain a zipped folder that includes all output from phylogenetic inference and the one of the consensus

**Viewtree***

Description:

Link to visualize consensus Tree of phylogenetic inference. It could be more than one link if the model assume more than one tree (combination topology + branch length set).

Use of the figure in the link below should be always accompagned by appropriate citation:

Letunic I and Bork P (2011) Nucleic Acids Res doi: 10.1093/nar/gkr201 Interactive Tree Of Life v2: online annotation and display of phylogenetic trees made eas

**Mrbayesoutput***

Description:

original output of mrbayes

**Detailspptest**

Description:

Numeric Result of the Posterior Predictive test.

**Partitionfinderoutput**

Description:

Main output of PartitionFinder, where the preffered partitioned model is described

**Log**

Description:

Log file of all application used in the workflow. For each external website is reported the name of the application , the jobid required to track error on the service provvider and the last 200line of the standardouput+standardError of the application as view by the local system where the job was run.

**Partitionfinderdetails***

Description:

Path were to retrieve all the detials of the partitionfinder software

**Geoksdetails***

Description:

Path were to get all details of convergence test calculation.

  
  
Ouput with * are also exposed on a downloadable link in the web browser as soon as they are produced  
**5.5. Results analysis**   
  
If the GeoKS test fail, the p-value is lower of the risk accepted by the user, the workflow stop and do not perform the posterior predictive test and the tree consensus calculation. User is invited to look at GeoKS result and increase the generation number of at least 1.5 times.  
  
If the GeoKS test do not fail, the p-value is higher of the risk accepted by the user, the user is invited to check that no more generation are advised by GeoKS. In fact the program advise the user for more generation if less that 300 Effective Sample Size (ESS) Tree are present in the posterior distribution. With less than 300 ESS trees the test do not guarantee to have sufficient power to detect correctly convergence. Then the user should look at the plot output and check if the red line (observed MSA complexity) is within the HSD of the distribution. If the red line is on the right of the distribution a more complex model need to be taken in consideration. if the red line is on the left of the distribution it could be than a more simple model could be entertained, and branch support are excessively conservative.  
  
Once the two tests are positive the user could inspect the consensus tree on ITOL, decorate at will and print on file the tree for a publication. The naked netwick tree could be also extracted using the option save tree from ITOL or directly from the output port newick  
  


## 6. Support

  
For questions with using the workflow, please write [support@biovel.eu][17].  
For definitions of technical and biological terms, please visit the BioVeL glossary page: [https://wiki.biovel.eu/display/BioVeL/Glossary][18]   
  


   [17]: mailto:support@biovel.eu
   [18]: https://wiki.biovel.eu/display/BioVeL/Glossary

## 7. Bibliography

  
  
1. Huelsenbeck JP, Larget B, Miller RE, Ronquist F. Potential applications and pitfalls of Bayesian inference of phylogeny. Systematic biology. 2002;51(5):673–88. Available at: [http://sysbio.oxfordjournals.org/content/51/5/673.abstract][19] [Accessed January 29, 2013].  
  
2. Huelsenbeck JP, Ronquist F. MRBAYES: Bayesian inference of phylogenetic trees. Bioinformatics (Oxford, England). 2001;17(8):754–5. Available at: [http://www.ncbi.nlm.nih.gov/pubmed/11524383][20] [Accessed January 29, 2013].  
  
3. Altekar G, Dwarkadas S, Huelsenbeck JP, Ronquist F. Parallel Metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference. Bioinformatics (Oxford, England). 2004;20(3):407–15. Available at: [http://www.ncbi.nlm.nih.gov/pubmed/14960467][21].  
  
4. Bollback JP. Bayesian Model Adequacy and Choice in Phylogenetics. Molecular biology and evolution. 2002;19(7):1171–1180.

   [19]: http://sysbio.oxfordjournals.org/content/51/5/673.abstract
   [20]: http://www.ncbi.nlm.nih.gov/pubmed/11524383
   [21]: http://www.ncbi.nlm.nih.gov/pubmed/14960467
</td>
              </tr>
            
          </table>
        
      </div>
    </div>
        
    <!-- Dependencies -->
        <div class="fold">
      <div class="foldTitle">
        <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[These are the listed dependencies of the workflow] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
        Dependencies (0)
      </div>
      <div class="foldContent" style="display: none;">
        
          <p class="none_text">None</p>
        
      </div>
    </div>
        
    <!-- Sources -->
        <div class="fold">
      <div class="foldTitle">
        Inputs (2)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
          
                          <tr>
                <td><b>File_name</b></td>
                <td>
                  
                    
                      Filename for nexus input file                       
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>Email</b></td>
                <td>
                  
                    
                      Email where to obtain notificaiont of the  job  conclusion.                        
                    
                  
                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
      
    <!-- Processors -->
        <div class="fold">
      <div class="foldTitle">
        Processors (7)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          
                          <tr>
                <td><b>RandGen</b></td>
                <td>localworker</td>
                <td>
                                    <div><h3>Script</h3><pre>import java.util.Random;

Random r = new Random();
Integer a=r.nextInt();
if (a<0){
	a=-1*a;
}
out=a ;

</pre></div>                </td>
              </tr>
                          <tr>
                <td><b>NoSpace</b></td>
                <td>beanshell</td>
                <td>
                                    <div><h3>Script</h3><pre>out1=string.replaceAll(" ","_");</pre></div>                </td>
              </tr>
                          <tr>
                <td><b>TargetOnly</b></td>
                <td>beanshell</td>
                <td>
                                    <div><h3>Script</h3><pre>out1=string.replaceAll(".+/","");</pre></div>                </td>
              </tr>
                          <tr>
                <td><b>Launch_GUI</b></td>
                <td>component</td>
                <td>
                                    <div><h3>Component</h3><a href="/workflows/3957?version=3">Launch_GUI</a></div>                </td>
              </tr>
                          <tr>
                <td><b>REST_Service</b></td>
                <td>rest</td>
                <td>
                                                    </td>
              </tr>
                          <tr>
                <td><b>XPath_Service</b></td>
                <td>xpath</td>
                <td>
                                    <div><h3>Xpath Expression</h3><pre>/Job/JobsID/JobId</pre></div>                </td>
              </tr>
                          <tr>
                <td><b>Text_constant</b></td>
                <td>stringconstant</td>
                <td>
                                    <div><h3>Value</h3>MrBayes_16CPUs</div>                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Beanshells -->
        <div class="fold">
      <div class="foldTitle">
        Beanshells (2)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th>Inputs</th>
              <th>Outputs</th>
            </tr>
          
                          <tr>
                <td><b>NoSpace</b></td>
                <td></td>
                <td>
                  
                    
                      string                      
                    
                  
                </td>
                <td>
                  
                    
                      out1                      
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>TargetOnly</b></td>
                <td></td>
                <td>
                  
                    
                      string                      
                    
                  
                </td>
                <td>
                  
                    
                      out1                      
                    
                  
                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Sinks -->
        <div class="fold">
      <div class="foldTitle">
        Outputs (3)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
          
                          <tr>
                <td><b>Log</b></td>
                <td>
                  
                </td>
              </tr>
                          <tr>
                <td><b>JobID</b></td>
                <td>
                  
                    
                      Use this job id  as input in the                       
                    
                  
                </td>
              </tr>
                          <tr>
                <td><b>FileName</b></td>
                <td>
                  
                </td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Datalinks -->
        <div class="fold">
      <div class="foldTitle">
        Datalinks (11)
      </div>
      <div class="foldContent" style="display: none;">
                  <table class="simple">
            <tr>
              <th>Source</th>
              <th>Sink</th>
            </tr>
          
                          <tr>
                <td>File_name</td>
                <td>NoSpace:string</td>
              </tr>
                          <tr>
                <td>Launch_GUI:MrBayesInput</td>
                <td>TargetOnly:string</td>
              </tr>
                          <tr>
                <td>NoSpace:out1</td>
                <td>Launch_GUI:FileName</td>
              </tr>
                          <tr>
                <td>RandGen:out</td>
                <td>Launch_GUI:Token</td>
              </tr>
                          <tr>
                <td>Text_constant:value</td>
                <td>REST_Service:name</td>
              </tr>
                          <tr>
                <td>Email</td>
                <td>REST_Service:mail</td>
              </tr>
                          <tr>
                <td>Launch_GUI:MrBayesInput</td>
                <td>REST_Service:arguments</td>
              </tr>
                          <tr>
                <td>REST_Service:responseBody</td>
                <td>XPath_Service:xml_text</td>
              </tr>
                          <tr>
                <td>Launch_GUI:Log</td>
                <td>Log</td>
              </tr>
                          <tr>
                <td>XPath_Service:firstNode</td>
                <td>JobID</td>
              </tr>
                          <tr>
                <td>TargetOnly:out1</td>
                <td>FileName</td>
              </tr>
            
          </table>
        
      </div>
    </div>
    
    <!-- Coordinations -->
        <div class="fold">
      <div class="foldTitle">
        Coordinations (0)
      </div>
      <div class="foldContent" style="display: none;">
        
          <p class="none_text">None</p>
        
      </div>
    </div>
  
    

          
      
    </div>

  </div>

</div>

<div class="contribution_right_box">
  <div class="contribution_section_box" style= "font-size: 100%; padding: 0.7em 0.9em; font-weight: bold;">
    <p><img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The type of workflow system that this Workflow is designed for.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" /> Workflow Type</p>
    <p><a href="/content_types/2">Taverna 2</a></p>
  </div>

  <div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The Uploader is the person who uploaded/created this Workflow on myExperiment, and who manages it on myExperiment.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Uploader
	</p>
	<p>
		<center>
			<div class="avatar" style="width: 66px">
  <a href="/users/20342"><img alt="3375?size=60x60" class="framed" src="/pictures/show/3375?size=60x60" title="Saverio Vicario" /></a>
  
	<span style="display:block;margin-top:2px;text-align:center;">
		
			<img alt="It" src="/images/famfamfam_flags/it.png?1680607579" style="vertical-align:middle; margin-right: 0.3em;" title="header=[] body=[&lt;b&gt;Location: &lt;/b&gt;Bari, Italy] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		

    
			<a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
		

    
	</span>
  
</div>

		</center>
	</p>
</div>


  

  

<div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This specifies what rights users have when they download and use this Workflow.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		License
		<a name="license"></a>
	</p>

  

    
    
    
    
    


    

    <!--

    <rdf:RDF xmlns="http://creativecommons.org/ns#"
        xmlns:dc="http://purl.org/dc/elements/1.1/"
        xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
    <Work rdf:about="">
       <dc:title>Bayesian Phylogenetic Inference: Select Model -  Submission</dc:title>
       <dc:date>2013-02-20 13:47:04 UTC</dc:date>
       <dc:description>&lt;p&gt;
BioVeL – Biodiversity Virtual e-Laboratory   
&lt;/p&gt;

&lt;p&gt;
Workflow Documentation   
&lt;/p&gt;

&lt;p&gt;
Name:Perform Short Bayesian Phylogenetic Inference  
&lt;/p&gt;

&lt;p&gt;
Capacities Programme of Framework 7: EC e-Infrastructure Programme –   
e-Science Environments - INFRA-2011-1.2.1   
Grant Agreement No: 283359   
Project Co-ordinator: Mr Alex Hardisty   
Project Homepage: [&lt;a href=&quot;http://www.biovel.eu][1&quot; rel=&quot;nofollow&quot;&gt;http://www.biovel.eu][1&lt;/a&gt;]
&lt;/p&gt;

&lt;p&gt;
   [1]: &lt;a href=&quot;http://www.biovel.eu&quot; rel=&quot;nofollow&quot;&gt;http://www.biovel.eu&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
##   
1 Description
&lt;/p&gt;

&lt;p&gt;
The Pack contain 3 workflows that perform and validate bayesian phylogenetic inference that differ from the kind of input. The pack is called short because the worlflow require that the user need to keep taverna engine always on for the the time of the analysis. This could be quite problematic for large analysis. In this case search help in the &quot;Perform Long Bayesian Phylogenetic Inference&quot; pack
&lt;/p&gt;

&lt;p&gt;
In this pack there are 3 workflows:
&lt;/p&gt;

&lt;p&gt;
1) User locally formatted input file (for details in nexus format for mrbayes [&lt;a href=&quot;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][2&quot; rel=&quot;nofollow&quot;&gt;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][2&lt;/a&gt;])  
&lt;/p&gt;

&lt;p&gt;
2) User is helped by a GUI (graphical user interface) to define an partitioned evolutionary model on user defined MSA (multiple sequence alignment)  
&lt;/p&gt;

&lt;p&gt;
3) PartitionFinder define best candidate partitioned evolutionary model based on proposed maximum set of possible partition  
&lt;/p&gt;

&lt;p&gt;
Note: a partitioned model is a model that allow different groups of sites (i.e. columns of the MSA) to follow the rule or parameters set of different evolutionary models. MrBayes allows that some of the parameters to be shared across partitions while other being different. The submit workflow 2 based on the GUI allow to fully take advantage of this features while the submit workflow 3 based on PartitionFinder allow to share across partition optionally branch length and always the topology  
&lt;/p&gt;

&lt;p&gt;
All 3 workflows perform 2 validations on the inference, one on the numerical integration (GeoKS) and one on the fit of the model (Posterior Predictive Test)  
&lt;/p&gt;

&lt;p&gt;
   [2]: &lt;a href=&quot;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2&quot; rel=&quot;nofollow&quot;&gt;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
## 2 General
&lt;/p&gt;

&lt;p&gt;
**2.1 Name of the workflow and myExperiment +BiodiversityCatalogue identifiers**  
Name: Perform Short Bayesian Phylogenetic Inference  
Download info: [&lt;a href=&quot;http://www.myexperiment.org/packs/371.html][3&quot; rel=&quot;nofollow&quot;&gt;http://www.myexperiment.org/packs/371.html][3&lt;/a&gt;]  
BiodiversityCatalogue entry:   
&lt;/p&gt;

&lt;p&gt;
**2.2 Date, version and licensing**  
Last [updated:21/02/13][4] @ 09:08:18  
Version: 2  
Licensing: Creative Commons Attribution ShareAlike CC-BY- SA  
&lt;/p&gt;

&lt;p&gt;
**2.3 How to cite this workflow**  
&lt;/p&gt;

&lt;p&gt;
These results come from the processing of data (personal source or others--cite which one, i.e. ENA) through BioVeL&#39;s services ([&lt;a href=&quot;http://www.biovel.eu][5&quot; rel=&quot;nofollow&quot;&gt;www.biovel.eu][5&lt;/a&gt;]). BioVeL is funded by the EU’s Seventh Framework Program, grant no. 283359. Use the article [&lt;a href=&quot;http://journal.embnet.org/index.php/embnetjournal/article/view/557][6&quot; rel=&quot;nofollow&quot;&gt;http://journal.embnet.org/index.php/embnetjournal/article/view/557][6&lt;/a&gt;]
&lt;/p&gt;

&lt;p&gt;
   [3]: &lt;a href=&quot;http://www.myexperiment.org/packs/371.html&quot; rel=&quot;nofollow&quot;&gt;http://www.myexperiment.org/packs/371.html&lt;/a&gt;
   [4]: &lt;a href=&quot;http://updated:21/02/13&quot; rel=&quot;nofollow&quot;&gt;http://updated:21/02/13&lt;/a&gt;
   [5]: &lt;a href=&quot;http://www.biovel.eu&quot; rel=&quot;nofollow&quot;&gt;http://www.biovel.eu&lt;/a&gt;
   [6]: &lt;a href=&quot;http://journal.embnet.org/index.php/embnetjournal/article/view/557&quot; rel=&quot;nofollow&quot;&gt;http://journal.embnet.org/index.php/embnetjournal/article/view/557&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
##   
&lt;/p&gt;

&lt;p&gt;
&lt;ol&gt;
&lt;li value=&quot;3&quot;&gt;Scientific Specifications&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;

&lt;p&gt;
**3.1. Keywords:** Phylogenetic inference, Bayesian, MrBayes, Posterior Predictive test, Convergence test  
**3.2. Scientific workflow description:**  
&lt;/p&gt;

&lt;p&gt;
The different step for a complete phylogenetic inference are in this pack divided as following:  
&lt;/p&gt;

&lt;p&gt;
  1. Define model framework
  2. Estimate parameters of the model framework with a Markovian Integration within a Bayesian framework
  3. Validate the convergence of the Markovian Integration with a test on the overlap of the tree posterior distribution of two or more independent runs (GeoKS)
  4. Test the adequacy or goodness of fit of the model with a posterior predictive test
&lt;/p&gt;

&lt;p&gt;
**3.2.1 Define model framework:**  
&lt;/p&gt;

&lt;p&gt;
MrBayes allows to define partitioned model of evolution of the character of the MSA, to perform a given phylogenetic inference. A  
&lt;/p&gt;

&lt;p&gt;
Partitioned model is a model that allow different groups of sites (i.e. columns of the MSA) to follow the rule or parameters set of different evolutionary models.  
&lt;/p&gt;

&lt;p&gt;
Within MrBayes is possible to define 5 group of parameters that can be shared or not across user defined group of sites  
&lt;/p&gt;

&lt;p&gt;
  1. Substitution Matrix
  2. State frequencies
  3. Site Specific rates
  4. Branch lengths
  5. Topology
&lt;/p&gt;

&lt;p&gt;
Workflow 1 &quot;All is ready to run&quot;. leave the user the duty to define and format a model using the criteria and tool preferred.  
&lt;/p&gt;

&lt;p&gt;
Workflow 2 &quot;Select Model&quot; based on a GUI help the user to define a model that share or not across user defined partition independently all 5 groups of parameters, taking care of the formatting.  
&lt;/p&gt;

&lt;p&gt;
Workflow 3 &quot;Select Model for Me&quot; based on PartitionFinder ([&lt;a href=&quot;http://www.robertlanfear.com/partitionfinder/][7&quot; rel=&quot;nofollow&quot;&gt;http://www.robertlanfear.com/partitionfinder/][7&lt;/a&gt;]) allows to define the best partitioning of the sites based on a starting maximal partitioning proposed by the user, but decision of the sharing or not across partition is done together for groups 1, 2, and 3 while branch lengths could be shared across all partition or none (no sharing across some partitions) and topology need to be shared across all sites.
&lt;/p&gt;

&lt;p&gt;
   [7]: &lt;a href=&quot;http://www.robertlanfear.com/partitionfinder/&quot; rel=&quot;nofollow&quot;&gt;http://www.robertlanfear.com/partitionfinder/&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
![][8] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; PhyloInfWFColorAll-renzo.png&quot; data-location=&quot;BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; PhyloInfWFColorAll-renzo.png&quot;&gt;  
&lt;/p&gt;

&lt;p&gt;
**3.2.2 Estimate parameters of the model framework with a Markovian Integration within a Bayesian framework:**  
&lt;/p&gt;

&lt;p&gt;
All 3 submit workflows send the input defined and formatted differently to the same service that start a MrBayes run. (ref 1,2,3)  
&lt;/p&gt;

&lt;p&gt;
**3.2.3 Validate the convergence of the Markovian Integration with a test on the overlap of the tree posterior distribution of two or more independent runs (GeoKS):**  
&lt;/p&gt;

&lt;p&gt;
The result of the MrBayes service are loaded by the retrieval workflow that perform a test of convergence based on the on the overlap of the tree posterior distribution of two or more independent runs. Details on this link  
&lt;/p&gt;

&lt;p&gt;
**3.2.4 Test the adequacy or goodness of fit of the model with a posterior predictive test**:  
&lt;/p&gt;

&lt;p&gt;
The service written in python read each estimation of set of parameters from a sub-sample of the overall posterior distribution and simulated (using evolver utility from PAML 1.4 package) new MSA. The simulated distribution is compared to the original MSA based on the sum of the sites entropy as proposed by Bollback (2002)[ref 4]  
&lt;/p&gt;

&lt;p&gt;
An Histogram is draw for the distribution of the complexities (log of sum of sites entropy or maximal possible loglikelihood score) of the simulated data using the posterior distribution parameters compared with observed data complexity. The 1-alpha high posterior density of the distribution show the region where simulate data complexity match the observed one. Larger observed complexity indicates model too simplistic, while the contrary indicates overparametrization of the model.
&lt;/p&gt;

&lt;p&gt;
   [8]: /download/attachments/8619115/PhyloInfWFColorAll-renzo.png?version=1&amp;modificationDate=1393242192541&amp;api=v2 (BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; PhyloInfWFColorAll-renzo.png)
&lt;/p&gt;

&lt;p&gt;
**3.2.5 Visualization of the consensus inference**
&lt;/p&gt;

&lt;p&gt;
The newick representation of the consensus of the inference is sent to the ITOL web service ([see details at &lt;a href=&quot;http://itol.embl.de/][9&quot; rel=&quot;nofollow&quot;&gt;http://itol.embl.de/][9&lt;/a&gt;]). The service allows to visualize an interactive graphical representation of the tree. After manipulation and editing the tree can be exported in several graphical format or downloaded as newick or phyloxml format. Relaoding the tree with this format togheter with user defined annotation table allows very powerfull graphical representation of the tree (see details on [&lt;a href=&quot;http://itol.embl.de/help/help.shtml][10&quot; rel=&quot;nofollow&quot;&gt;http://itol.embl.de/help/help.shtml][10&lt;/a&gt;])
&lt;/p&gt;

&lt;p&gt;
   [9]: &lt;a href=&quot;http://itol.embl.de/&quot; rel=&quot;nofollow&quot;&gt;http://itol.embl.de/&lt;/a&gt;
   [10]: &lt;a href=&quot;http://itol.embl.de/help/help.shtml&quot; rel=&quot;nofollow&quot;&gt;http://itol.embl.de/help/help.shtml&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
## 4. Technical Specifications
&lt;/p&gt;

&lt;p&gt;
**4.1. Execution environment and installation requirements**  
&lt;/p&gt;

&lt;p&gt;
The 3 workflows are all tested on taverna workbench. They should be able to be loaded on Taverna Lite  
**4.2. Taverna installation, including updates and plug-ins**
&lt;/p&gt;

&lt;p&gt;
[Taverna workbench installation][11]  
[Interaction plug-in][12]  
**4.2.1 Taverna Dependencies**  
&lt;/p&gt;

&lt;p&gt;
The all 3 workflow require a local R serve to allow to draw the graph output of the Posterior Predictive Test.  
&lt;/p&gt;

&lt;p&gt;
The Workflow 3 based on Partition Finder, requires a python interpret installed on the path and accessible to Taverna engine. No python module is required by the script and although tested only with python 2.7 should work also with older python.   
&lt;/p&gt;

&lt;p&gt;
   [11]: &lt;a href=&quot;https://wiki.biovel.eu/display/doc/Taverna+Workbench&quot; rel=&quot;nofollow&quot;&gt;https://wiki.biovel.eu/display/doc/Taverna+Workbench&lt;/a&gt;
   [12]: &lt;a href=&quot;https://wiki.biovel.eu/display/doc/Customising+for+BioVeL#CustomisingforBioVeL-InstallingtheInteractionplug-in&quot; rel=&quot;nofollow&quot;&gt;https://wiki.biovel.eu/display/doc/Customising+for+BioVeL#CustomisingforBioVeL-InstallingtheInteractionplug-in&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
## 5. Tutorial - how to do it
&lt;/p&gt;

&lt;p&gt;
**5.1. Introduction**  
&lt;/p&gt;

&lt;p&gt;
The user depending of the 3 different scenarios presented in 3.2.1 will choose one of the 3 submit workflows.  
**5.2. Input data**  
**5.2.1. Data preparation/format**  
&lt;/p&gt;

&lt;p&gt;
Workflow 1 the format for the input (called&quot;NexusFile&quot;) is nexus with data block and mrbayes block. Within the data block the MSA is specified together with the type of possible states, while in the mrbayes block the user need to define the evolutionary model and the parameters for the markovian integration ( number of generation, temperature, number of chain for the metropolis coupled part of the algorithm, and number of replicates runs to control convergence). See details in [&lt;a href=&quot;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][13&quot; rel=&quot;nofollow&quot;&gt;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2][13&lt;/a&gt;]  
&lt;/p&gt;

&lt;p&gt;
Workflow 2 and 3 require a MSA in aligned multifasta format (see [&lt;a href=&quot;http://en.wikipedia.org/wiki/FASTA_format][14&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/FASTA_format][14&lt;/a&gt;]). Recognized gap character is &quot;-&quot;  
&lt;/p&gt;

&lt;p&gt;
Workflow 3 require also a text in which user define maximum set of parts fo the alignment, meaning the maximal subdivision in group that sites could have. Mind the Partitionfinder try all combinatorial change possible and is not adivsed to propose more than 14 parts.
&lt;/p&gt;

&lt;p&gt;
   [13]: &lt;a href=&quot;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2&quot; rel=&quot;nofollow&quot;&gt;http://mrbayes.sourceforge.net/wiki/index.php/Manual_3.2&lt;/a&gt;
   [14]: &lt;a href=&quot;http://en.wikipedia.org/wiki/FASTA_format&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/FASTA_format&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
Syntax to define partition is the following:
&lt;/p&gt;

&lt;p&gt;
Each part is defined by a alpha numeric string with no space (the name) connected by an equal sign to the list of sites to be included. Description end with the semicolon sign.
&lt;/p&gt;

&lt;p&gt;
A range of sites are described as start and ending sites divided by minus sign (i.e. gene1= 10-30;) with both start and end included
&lt;/p&gt;

&lt;p&gt;
Discontinue sections are divided by a space (i.e. gene1= 10-30 34 40;)
&lt;/p&gt;

&lt;p&gt;
Range with a step (i.e.“every third base”) are expressed with a slash (i.e. gene1= 10-30\3;)
&lt;/p&gt;

&lt;p&gt;
So a complex but realistic example could be:
&lt;/p&gt;

&lt;p&gt;
utr5= 1-30;
&lt;/p&gt;

&lt;p&gt;
cds_pos1 = 30-200/3 400-500/3;
&lt;/p&gt;

&lt;p&gt;
cds_pos2 = 31-200/3 399-500/3;
&lt;/p&gt;

&lt;p&gt;
cds_pos3 = 32-200/3 398-500/3;
&lt;/p&gt;

&lt;p&gt;
intron= 200-397;
&lt;/p&gt;

&lt;p&gt;
utr3= 501-600;
&lt;/p&gt;

&lt;p&gt;
**5.2.2. Other input   
**
&lt;/p&gt;

&lt;p&gt;
file name: name for the nexus file produced on the basis of partitionFinder results
&lt;/p&gt;

&lt;p&gt;
number of MCMCMC generations: integer indicating number of generation to be used in the markovian integration
&lt;/p&gt;

&lt;p&gt;
number of runs: integer indicating how many indipendent runs of mrbayes need to be performed ( the more the better convergence is detected
&lt;/p&gt;

&lt;p&gt;
branch length are linked or unlinked across partition: see 3.2.1 for details
&lt;/p&gt;

&lt;p&gt;
what criterium to be used by PartitionFinder: the criteria a AIC, AICc and BIC. All of them are information criteria. In general statistical framework AIC should be always prefferrd to AIC but in phylogenetics there are dispute on how to count constant sites. If your MSA have very few constant sites or you selected your locus randomly use AICc without doubt. For large MSA AIC and AICc give similar results.
&lt;/p&gt;

&lt;p&gt;
**5.3. Select Dialogue boxes**
&lt;/p&gt;

&lt;p&gt;
For each web services called a message tell the user the name and the number of the job id to the user. The message disappear after the user would push any of the buttons or if another web services is called before any action is taken. The message allows the user to know at what point of the workflow is and gives the job id number that would allow the service centre to identify the job, in case of failure.
&lt;/p&gt;

&lt;p&gt;
![][15] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.53.43.png&quot; data-location=&quot;BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.53.43.png&quot;&gt;  
Workflow 1 does not have specific dialog box  
&lt;/p&gt;

&lt;p&gt;
Worklfow 2 have a large and complex self explanatory web page. To start to use paste a aligned multifasta file in the only visible text window and click confirm. Following choice are explained by yellow bottom on the side of each question or pull down menu  
&lt;/p&gt;

&lt;p&gt;
Workflow 3 have following dialog box:
&lt;/p&gt;

&lt;p&gt;
   [15]: /download/attachments/8619115/Schermata%202013-08-09%20alle%2015.53.43.png?version=1&amp;modificationDate=1376213644377&amp;api=v2 (BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.53.43.png)
&lt;/p&gt;

&lt;p&gt;
partition to be selected: this windows allows to choose a subset of partition to be used. At the moment is not relevant but coupling this workflow with alignment this windows could be not redundant
&lt;/p&gt;

&lt;p&gt;
![][16] Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.39.49.png&quot; data-location=&quot;BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.39.49.png&quot;&gt;  
&lt;/p&gt;

&lt;p&gt;
**5.4. Save data/results**   
&lt;/p&gt;

&lt;p&gt;
The 3 workflows have the following outputs:
&lt;/p&gt;

&lt;p&gt;
   [16]: /download/attachments/8619115/Schermata%202013-08-09%20alle%2015.39.49.png?version=1&amp;modificationDate=1376213738892&amp;api=v2 (BioVeL User Documentation &gt; Define, perform and validate a Bayesian Phylogenetic Inference - Taverna engine always on or from BioVeL Portal &gt; Schermata 2013-08-09 alle 15.39.49.png)
&lt;/p&gt;

&lt;p&gt;
**Plot**
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Result of the Posterior Predictive test. Histogram of the distribution of the complexities (log of sum of sites entropy or maximal possible loglikelihood score) of the simulated data using the posterior distribution parameters compared with observed data complexity. The 1-alpha high posterior density of the distribution show the region where simulate data complexity match the observed one. Larger observed complexity indicates model too simplistic, while the contrary indicates overparametrization of the model
&lt;/p&gt;

&lt;p&gt;
**Newicktree**
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
small xml with tag res with one or more tag tree each one with a body that contain a tree in netwick format.
&lt;/p&gt;

&lt;p&gt;
each tree represent the consensus for a given partition of group of partition in the same order that are cited in the nexus input file of mrbayes
&lt;/p&gt;

&lt;p&gt;
**Geoks**
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Result of the GeoKS test of convergence. XML format
&lt;/p&gt;

&lt;p&gt;
**Phyloinferenceoutput** *
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
The output of the consensus service is a path were to obtain a zipped folder that includes all output from phylogenetic inference and the one of the consensus
&lt;/p&gt;

&lt;p&gt;
**Viewtree***
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Link to visualize consensus Tree of phylogenetic inference. It could be more than one link if the model assume more than one tree (combination topology + branch length set).
&lt;/p&gt;

&lt;p&gt;
Use of the figure in the link below should be always accompagned by appropriate citation:
&lt;/p&gt;

&lt;p&gt;
Letunic I and Bork P (2011) Nucleic Acids Res doi: 10.1093/nar/gkr201 Interactive Tree Of Life v2: online annotation and display of phylogenetic trees made eas
&lt;/p&gt;

&lt;p&gt;
**Mrbayesoutput***
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
original output of mrbayes
&lt;/p&gt;

&lt;p&gt;
**Detailspptest**
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Numeric Result of the Posterior Predictive test.
&lt;/p&gt;

&lt;p&gt;
**Partitionfinderoutput**
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Main output of PartitionFinder, where the preffered partitioned model is described
&lt;/p&gt;

&lt;p&gt;
**Log**
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Log file of all application used in the workflow. For each external website is reported the name of the application , the jobid required to track error on the service provvider and the last 200line of the standardouput+standardError of the application as view by the local system where the job was run.
&lt;/p&gt;

&lt;p&gt;
**Partitionfinderdetails***
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Path were to retrieve all the detials of the partitionfinder software
&lt;/p&gt;

&lt;p&gt;
**Geoksdetails***
&lt;/p&gt;

&lt;p&gt;
Description:
&lt;/p&gt;

&lt;p&gt;
Path were to get all details of convergence test calculation.
&lt;/p&gt;

&lt;p&gt;
Ouput with * are also exposed on a downloadable link in the web browser as soon as they are produced  
**5.5. Results analysis**   
&lt;/p&gt;

&lt;p&gt;
If the GeoKS test fail, the p-value is lower of the risk accepted by the user, the workflow stop and do not perform the posterior predictive test and the tree consensus calculation. User is invited to look at GeoKS result and increase the generation number of at least 1.5 times.  
&lt;/p&gt;

&lt;p&gt;
If the GeoKS test do not fail, the p-value is higher of the risk accepted by the user, the user is invited to check that no more generation are advised by GeoKS. In fact the program advise the user for more generation if less that 300 Effective Sample Size (ESS) Tree are present in the posterior distribution. With less than 300 ESS trees the test do not guarantee to have sufficient power to detect correctly convergence. Then the user should look at the plot output and check if the red line (observed MSA complexity) is within the HSD of the distribution. If the red line is on the right of the distribution a more complex model need to be taken in consideration. if the red line is on the left of the distribution it could be than a more simple model could be entertained, and branch support are excessively conservative.  
&lt;/p&gt;

&lt;p&gt;
Once the two tests are positive the user could inspect the consensus tree on ITOL, decorate at will and print on file the tree for a publication. The naked netwick tree could be also extracted using the option save tree from ITOL or directly from the output port newick  
&lt;/p&gt;

&lt;p&gt;
## 6. Support
&lt;/p&gt;

&lt;p&gt;
For questions with using the workflow, please write [&lt;a href=&quot;mailto:support@biovel.eu&quot; rel=&quot;nofollow&quot;&gt;support@biovel.eu&lt;/a&gt;][17].  
For definitions of technical and biological terms, please visit the BioVeL glossary page: [&lt;a href=&quot;https://wiki.biovel.eu/display/BioVeL/Glossary][18&quot; rel=&quot;nofollow&quot;&gt;https://wiki.biovel.eu/display/BioVeL/Glossary][18&lt;/a&gt;]   
&lt;/p&gt;

&lt;p&gt;
   [17]: mailto:&lt;a href=&quot;mailto:support@biovel.eu&quot; rel=&quot;nofollow&quot;&gt;support@biovel.eu&lt;/a&gt;
   [18]: &lt;a href=&quot;https://wiki.biovel.eu/display/BioVeL/Glossary&quot; rel=&quot;nofollow&quot;&gt;https://wiki.biovel.eu/display/BioVeL/Glossary&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
## 7. Bibliography
&lt;/p&gt;

&lt;p&gt;
&lt;ol&gt;
&lt;li value=&quot;1&quot;&gt;Huelsenbeck JP, Larget B, Miller RE, Ronquist F. Potential applications and pitfalls of Bayesian inference of phylogeny. Systematic biology. 2002;51(5):673–88. Available at: [&lt;a href=&quot;http://sysbio.oxfordjournals.org/content/51/5/673.abstract][19&quot; rel=&quot;nofollow&quot;&gt;http://sysbio.oxfordjournals.org/content/51/5/673.abstract][19&lt;/a&gt;] [Accessed January 29, 2013].  &lt;/li&gt;
&lt;li value=&quot;2&quot;&gt;Huelsenbeck JP, Ronquist F. MRBAYES: Bayesian inference of phylogenetic trees. Bioinformatics (Oxford, England). 2001;17(8):754–5. Available at: [&lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/11524383][20&quot; rel=&quot;nofollow&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/11524383][20&lt;/a&gt;] [Accessed January 29, 2013].  &lt;/li&gt;
&lt;li value=&quot;3&quot;&gt;Altekar G, Dwarkadas S, Huelsenbeck JP, Ronquist F. Parallel Metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference. Bioinformatics (Oxford, England). 2004;20(3):407–15. Available at: [&lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/14960467][21&quot; rel=&quot;nofollow&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/14960467][21&lt;/a&gt;].  &lt;/li&gt;
&lt;li value=&quot;4&quot;&gt;Bollback JP. Bayesian Model Adequacy and Choice in Phylogenetics. Molecular biology and evolution. 2002;19(7):1171–1180.&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;

&lt;p&gt;
   [19]: &lt;a href=&quot;http://sysbio.oxfordjournals.org/content/51/5/673.abstract&quot; rel=&quot;nofollow&quot;&gt;http://sysbio.oxfordjournals.org/content/51/5/673.abstract&lt;/a&gt;
   [20]: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/11524383&quot; rel=&quot;nofollow&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/11524383&lt;/a&gt;
   [21]: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/14960467&quot; rel=&quot;nofollow&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/14960467&lt;/a&gt;
&lt;/p&gt;

</dc:description>
       <dc:creator><Agent>
          <dc:title><a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a></dc:title>
       </Agent></dc:creator>
       <dc:rights><Agent>
          <dc:title><a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a></dc:title>
       </Agent></dc:rights>
       <dc:type rdf:resource="http://purl.org/dc/dcmitype/Data" />
       <dc:source rdf:resource="http://www.myexperiment.org/workflows/3408.html"/>
       <license rdf:resource="http://creativecommons.org/licenses/by-sa/3.0/" />
    </Work>

    <License rdf:about="http://creativecommons.org/licenses/by-sa/3.0/">
      <permits rdf:resource="http://creativecommons.org/ns#Reproduction" />  <permits rdf:resource="http://creativecommons.org/ns#Distribution" />  <requires rdf:resource="http://creativecommons.org/ns#Notice" />  <requires rdf:resource="http://creativecommons.org/ns#Attribution" />  <permits rdf:resource="http://creativecommons.org/ns#DerivativeWorks" />  <requires rdf:resource="http://creativecommons.org/ns#ShareAlike" />
    </License>

    </rdf:RDF>

    -->

  

  <div class="contribution_currentlicense">
    <p>
      
        All versions of this Workflow are
      
      
        licensed under: <br/><br/><a rel="Copyright" href="/licenses/2" title="Creative Commons Attribution-Share Alike 3.0 Unported License"><img src="/images/by-sa.png" /></a>
      
    </p>
  </div>
	
</div>


  <script type="text/javascript">
    function showVersion(form) {
        var url = $("resource_versions").value;
        location.href = url;
        form.submit
    }
</script>
<style>
  .version_selection {
      font-size:smaller;
      text-align: center;
  }
</style>

<div class="contribution_section_box">
  <p class="heading">
    <img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[This box shows version 4 for this entry] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />    <span>Version 4 (latest)</span>
    <span class="count_text">(of 4)</span>
  </p>
  
      <form onsubmit="showVersion(this); return false;" style="text-align: right;">
        <p class="version_selection">
        View version:
        <select id="resource_versions" onchange="showVersion(this.form)">
          
              <option value="/workflows/3408/versions/4" selected>
                4 (latest)
              </option>
          
              <option value="/workflows/3408/versions/3" >
                3 
              </option>
          
              <option value="/workflows/3408/versions/2" >
                2 
              </option>
          
              <option value="/workflows/3408/versions/1" >
                1 (earliest)
              </option>
          
        </select>
        </p>
      </form>
  
</div>

  <div class="contribution_section_box">
	
	<p class="heading" style="margin-bottom: 0; padding-bottom: 0;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[Which people/groups get the credit for this Workflow?] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Credits <span class="count_text">(3)</span>
		<a name="credits"></a>
	</p>
	<span style="font-size: 85%; color: #666666; display: block; padding: 0.3em 0.5em 0 0.5em; margin: 0; line-height: 1em;">(People/Groups)</span>
	
		<div style="font-size: 85%;">
			<ul class="items">
				
					<li>
						
							
								<span class="icon"><img alt="User" src="/images/famfamfam_silk/user.png?1680607579" /> </span> 
							
							<a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
						
					</li>
				
					<li>
						
							
								<span class="icon"><img alt="User" src="/images/famfamfam_silk/user.png?1680607579" /> </span> 
							
							<a href="/users/18953" title="header=[] body=[Giacinto Donvito] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Giacinto Donvito</a>
						
					</li>
				
					<li>
						
							
								<span class="icon"><img alt="User" src="/images/famfamfam_silk/user.png?1680607579" /> </span> 
							
							<a href="/users/27680" title="header=[] body=[Bachirb] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Bachirb</a>
						
					</li>
				
			</ul>
		</div>
	
	
	
	<p class="heading" style="margin-bottom: 0; padding-bottom: 0;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[What other Workflows/Files is this one based on?] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Attributions <span class="count_text">(0)</span>
		<a name="attributions"></a>
	</p>
	<span style="font-size: 85%; color: #666666; display: block; padding: 0.3em 0.5em 0 0.5em; margin: 0; line-height: 1em;">(Workflows/Files)</span>
	
		<p class="none_text">None</p>
	
	
	
	
</div>


  


  <div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The tags for this Workflow entry.&lt;br/&gt;Note(1): if this Workflow has many versions, the tags apply to ALL versions in this entry.&lt;br/&gt;Note(2): the size of the tags show how popular they are on myExperiment.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Tags <span id="tags_box_header_tag_count_span" class="count_text">(2)</span>
		<a name="tags"></a>
	</p>

	<script type="text/javascript">
  function showAllTags() {
    Element.show('all_tags');
	  Element.hide('user_tags');
	  return false;
  }
  
  function showUsersTags() {
  	Element.hide('all_tags');
	  Element.show('user_tags');
	  return false;
  }
	
	function flip_tags_mode()
	{
		if( $('toggle_tags_mode').checked )
		  showUsersTags();
	  else
		  showAllTags();
	}
</script>

<div id="tags_inner_box">
	
		<div class="box_currentuser_specific" style="padding: 0.3em 0.2em; margin: 0.6em 0.4em;">
		  <label for="toggle_tags_mode" style="font-size: 85%; font-weight: bold;"><input id="toggle_tags_mode" name="toggle_tags_mode" onclick="flip_tags_mode();" style="margin-right: 0.3em;" type="checkbox" value="1" />Uploader tags</label>
		</div>
		<div id="all_tags">
			
				<div class="hTagcloud">
  <ul class="popularity">
    <li><a href='/tags/4121' class='vvvv-popular'>phylogenetics</a></li>
<li> | </li>
    <li><a href='/tags/1165' class='vvvv-popular'>phylogeny</a></li>
  </ul>
</div>

			
		</div>
		<div id="user_tags"  style="display: none;">
			
				<div class="hTagcloud">
  <ul class="popularity">
    <li><a href='/tags/4121' class='vvvv-popular'>phylogenetics</a></li>
<li> | </li>
    <li><a href='/tags/1165' class='vvvv-popular'>phylogeny</a></li>
  </ul>
</div>

			
		</div>
	
</div>
	
	
	
	
		<p><small><b><a href="/session/new">Log in</a></b> to add Tags</small></p>
	
</div>


  
<div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[All the Groups that this item has been shared with] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Shared with Groups <span class="count_text">(2)</span>
	</p>
	
		<div style="font-size: 85%;">
			<ul class="items">
				
					<li>
						<span class="icon"><img alt="Network-member" src="/images/famfamfam_silk/group.png?1680607579" /> </span>
						<a href="/groups/1013">BioVeL internal</a>
					</li>
				
					<li>
						<span class="icon"><img alt="Network-member" src="/images/famfamfam_silk/group.png?1680607579" /> </span>
						<a href="/groups/643">BioVeL</a>
					</li>
				
			</ul>
		</div>
	
</div>

  <div class="contribution_section_box" id="in_packs_box">
  
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[All the Packs that this item (or versions of this item [[if available]]) is referred to in] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Featured In Packs  <span class="count_text">(1)</span>
		<a name="featured_in_packs"></a>
	</p>
	
		<div style="font-size: 85%;">
			<ul class="items">
				
					<li>
						
							<span class="icon"><img alt="Pack" src="/images/manhattan_studio/folder-closed_16.png?1680607579" /> </span>
							<a href="/packs/370">Perform Long Bayesian Phylogenetic Inference</a>
						
					</li>
				
			</ul>
		</div>
	
	
	
		<p><small><b><a href="/session/new">Log in</a></b> to add to one of your Packs</small></p>
	
</div>


  <div class="contribution_section_box">
	
	<p class="heading" style="margin-bottom: 0; padding-bottom: 0;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[Shows files and workflows that have attributed this Workflow.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Attributed By <span class="count_text">(0)</span>
	  <a name="attributed_by"></a>
	</p>
	<span style="font-size: 85%; color: #666666; display: block; padding: 0.3em 0.5em 0 0.5em; margin: 0; line-height: 1em;">(Workflows/Files)</span>
	
		
		<p class="none_text">None</p>
	
	
</div>


  
<div class="contribution_section_box">
	<p class="heading">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[The users who have added this Workflow to their favourites] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Favourited By <font class="count_text">(0)</font>
		<a name="favourited_by"></a>
	</p>
	
	
		<p class="none_text">No one</p>
	
	
	
</div>

  

<div class="contribution_section_box">
	<p class="heading" style="margin-bottom: 0.3em;">
		<img alt="Information" src="/images/famfamfam_silk/information.png?1680607579" style="vertical-align:middle;" title="header=[] body=[Viewing / download counts are grand totals for this Workflow.&lt;br/&gt;Click &#39;see breakdown&#39; to view details.] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]" />
		Statistics
	</p>
	
	<div class="stats_box"> 
		<p style="font-size: 85%;">
  1950 viewings
</p>

	<p style="font-size: 85%;">
	  779 downloads
	</p>

<p style="margin-top: 0.2em;">
	<small>[ <a href="/workflows/3408/statistics">see breakdown</a> ]</small>
</p>
		
		<div class="fold" style="padding-top: 0.6em;">
			<div class="foldTitle">More</div>
			<div class="foldContent" style="display: none; text-align: left;">
				
					<p>
						<a href="#credits">3 credits</a> <!-- won't work for type=='group'; needs anchor called '#group_creditations' -->
					</p>
					
					<p>
						<a href="#attributions">0 attributions</a>
					</p>
				
				
				
					<p>
			      <a href="#tags">2 tags</a>
			    </p>
				
				
				
					<p>
			      <a href="#favourited_by">0 favourites</a>
			    </p>
				

				
					<p>
						<a href="#citations">0 citations</a>
			    </p>
				
				
				
					<p>
			      <a href="#reviews">0 reviews</a>
			    </p>
				
				
				
			    <p>
			    	<a href="#comments">1 comment</a>
			    </p>
				
			</div>
		</div>
		
		
		
		
	</div>
</div>

</div>

<div class="clearer">&nbsp;</div>

<!-- BEGIN tabs -->

<br/>

<div id="tabsContainer" class="tabsContainer"></div>

<div class="tabContainer">
  <div class="tabTitle">Citations (0)</div>
  <div class="tabContent">

    <a name="citations"></a>
    
      <p><i>None</i></p>
    
		
		<br/>

    

  </div>
</div>


<div class="tabContainer">
  <div class="tabTitle">Version History</div>
  <div class="tabContent">
    <a name="version_history"></a>
    <p>In chronological order:</p>

<ol class="version_history">
  
    <li>
      <div class="title">
        <a href="/workflows/3408/versions/1">Phylogenetic inference with MrBayes and NoGUI, test of MCMC convergence (GEOKS) and fit of the model on the data (Posterior Predictive test)</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
          
          on Wednesday 20 February 2013 13:47:04 (UTC)
        </p>

        

        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3408/versions/2">Submit Phylogenetic inference with MrBayes and GUI to define model</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
          
          on Wednesday 20 February 2013 13:49:36 (UTC)
        </p>

        

        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3408/versions/3">Bayesiam Phylogenetic Infererence: Input Ready -  Submission</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
          
          on Friday 04 July 2014 09:31:21 (UTC)
        </p>

        

        
          <p>
            <div>Revision comment:</div>
            <div class="comment">
              <p>Version with component and up to date with short run version&nbsp;</p>
            </div>
          </p>
        
      </div>
    </li>
  
    <li>
      <div class="title">
        <a href="/workflows/3408/versions/4">Bayesian Phylogenetic Inference: Select Model -  Submission</a>
      </div>
      <div class="metadata">

        <p>
          Created
          
            by <a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
          
          on Friday 04 July 2014 09:53:04 (UTC)
        </p>

        
          <p>
            Last edited
            
              by <a href="/users/20342" title="header=[] body=[Saverio Vicario] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Saverio Vicario</a>
            
            on Friday 12 June 2015 13:39:23 (UTC)
          </p>
        

        
      </div>
    </li>
  
</ol>


  </div>
</div>



<!-- END tabs -->

<br/>
<br/>

<div id="ratingsBox">
  <h2>
	<span class="icon"><img alt="Reviews" src="/images/famfamfam_silk/report.png?1680607579" /> </span>	<span style="vertical-align: middle;"><a href="/workflows/3408/reviews">Reviews</a></span>
	<span class="count_text" style="vertical-align: middle;">(0)</span>
</h2>

<div class="reviewsBox">

	
		<p><i>No reviews yet</i></p>
		<a name="reviews"></a>
		<p style="margin-top: 0.6em;">
			<strong><a href="/workflows/3408/reviews/new">Be the first to review!</a></strong>
		</p>
	
	
</div>

</div>

<br/>
<br/>

<div id="commentsBox">
  <script src="/javascripts/ckeditor/ckeditor.js?1680607579" type="text/javascript"></script>
<script src="/javascripts/widgets/tooltip.js?1680607579" type="text/javascript"></script>

<h2>
	<span class="icon"><img alt="Comments" src="/images/famfamfam_silk/comments.png?1680607579" /> </span>	<span style="vertical-align: middle;">Comments</span>
	<span class="count_text" style="vertical-align: middle;">(1)</span>
</h2>

<ul class="sectionIcons">
  <li><span class="icon"><a href="http://www.myexperiment.org/workflows/3408/comments/timeline"><img alt="Timeline" src="/images/famfamfam_silk/timeline_marker.png?1680607579" /> View Timeline</a></span></li>
</ul>

<div class="commentsBox">
	
	
		
			<p><strong><a href="/session/new">Log in</a> to make a comment </strong></p>
		
		<a name="comments"></a>
		<ul id="comments" class="comments">
			<li>
	<a name='comment_791'></a>
  <table class="comment">
    <tr>
      <td class="avatar" rowspan="3">
        <div class="avatar" style="width: 66px">
  <a href="/users/63332"><img alt="Avatar" class="framed" height="60" src="/images/avatar.png?1680607579" title="Adrian  Diaz Meza" width="60" /></a>
  
	<span style="display:block;margin-top:2px;text-align:center;">
		
			
		

    
			<a href="/users/63332" title="header=[] body=[Adrian  Diaz Meza] cssheader=[boxoverTooltipHeader] cssbody=[boxoverTooltipBody] delay=[200]">Adrian  Diaz Meza</a>
		

    
	</span>
  
</div>

      </td>
      <td class="header" height="1.2em">
	      Tuesday 18 November 2014 20:58:21 (UTC)
	  </td>
    </tr>
	<tr>
	  <td class="content">        
    	<p>Hello my friend.</p><p>how do I create a workflow to send an email to a specific user?</p>
	  </td>
	</tr>
	<tr>
		<td style="text-align: right; padding-right: 1em;">
      
      
		</td>
	</tr>
  </table>
</li>

		</ul>
	
	
	<br/>
	
	

</div>


</div>

<!-- Other workflows that use a service this workflow users -->

<br />
<br />

<h2>
  <span class="icon"><img alt="Workflow" src="/images/redmond_studio/applications_16.png?1680607579" /> </span>  <span style="vertical-align: middle;">Other workflows that use similar services</span>
  <span class="count_text" style="vertical-align: middle;">(0)</span>
</h2>




    <p>There are no workflows in myExperiment that use similar services to this Workflow.</p>



<!-- OpenURL context object -->

<span class="Z3988" title="url_ver=Z39.88-2004&amp;url_ctx_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Actx&amp;ctx_ver=Z39.88-2004&amp;ctx_tim=2023-08-16T15%3A27%3A33%2B00%3A00&amp;ctx_id=&amp;ctx_enc=info%3Aofi%2Fenc%3AUTF-8&amp;rft.title=Bayesian+Phylogenetic+Inference%3A+Select+Model+-++Submission&amp;rft.date=2013-02-20&amp;rft.au=Saverio+Vicario&amp;rft.genre=unknown&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc"></span>
      </div>
    </div>




            <div id="ft">
          <div class="container">
  <div class="row">
    <div class="col-md-4 text-left">
      Funded by:
      <a href="http://biovel.eu">BioVeL</a>,
      <a href="http://www.epsrc.ac.uk/">EPSRC</a>,
      <a href="http://jisc.ac.uk/">JISC</a>,
      <a href="http://www.microsoft.com">Microsoft</a>

      <br/><br/>

      Affiliates:
      <a href="http://www.mygrid.org.uk">myGrid</a>,
      <a href="http://www.taverna.org.uk/">Taverna</a>,
      <a href="http://www.biocatalogue.org">BioCatalogue</a>
    </div>

    <div class="col-md-4 text-center">
      <a href="/about">About</a> |
      <a href="/privacy">Privacy</a> |
      <a href="http://wiki.myexperiment.org/index.php/Papers">Publications</a> |
      <a href="/feedback">Contact / Feedback</a> |
      <a href="http://lists.nongnu.org/mailman/listinfo/myexperiment-discuss">Mailing List</a>
    </div>

    <div class="col-md-4 text-right">
      Icons: <a href="http://www.famfamfam.com/lab/icons/silk/">Silk icon set 1.3</a><br/><br/>
      
    </div>

  </div>
  <div class="row">
    <div class="col-md-12 text-center">
      Copyright &#169; 2007 &ndash; 2018
      <a href="http://www.manchester.ac.uk/">The University of Manchester</a>
      and
      <a href="http://www.soton.ac.uk/">University of Southampton</a>
    </div>
  </div>
</div>

        </div>
    



<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1498417-4', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>



  
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36850736-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  


</body>
</html>

